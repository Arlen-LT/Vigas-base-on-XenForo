var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,d){b instanceof String&&(b=String(b));for(var h=b.length,a=0;a<h;a++){var c=b[a];if(f.call(d,c,a,b))return{i:a,v:c}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){b!=Array.prototype&&b!=Object.prototype&&(b[f]=d.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,f,d,h){if(f){d=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var a=b[h];a in d||(d[a]={});d=d[a]}b=b[b.length-1];h=d[b];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6","es3");
!function(b,f,d,h){XF.TokenInput=XF.Element.newHandler({options:{tokens:[","],minLength:2,maxLength:0,maxTokens:0,selectOnClose:!1,acUrl:"",listData:{}},$container:null,$selection:null,$hiddenInput:null,init:function(){var a=this.$target,c=this.options,g=a.clone().insertAfter(a).prop("type","hidden").removeAttr("data-xf-init").removeAttr("id"),k={tags:!0,width:"100%",containerCssClass:"input",language:XF.TokenInput.Phrases,minimumInputLength:c.minLength,maximumInputLength:c.maxLength,maximumSelectionLength:c.maxTokens,
selectOnClose:c.selectOnClose,disabled:a.prop("disabled"),placeholder:this.$target.attr("placeholder")};try{k.tokenSeparators=b.parseJSON(c.tokens)}catch(l){k.tokenSeparators=c.tokens}c.acUrl&&(k.ajax={delay:250,data:XF.proxy(this,"prepareAjax"),transport:XF.proxy(this,"getAjax"),processResults:XF.proxy(this,"processAjax")},k.escapeMarkup=function(a){return a},k.sorter=XF.proxy(this,"sortResults"),k.templateResult=XF.proxy(this,"prepareResults"),k.templateSelection=XF.proxy(this,"prepareSelection"));
if(c.listData){var d=[];b.each(c.listData,function(a,b){d.push({id:a,text:b})});k.data=d}a.remove();var e=b('<select name="tokens_select" multiple="multiple" class="js-tokenSelect"></select>').insertBefore(g).select2(k);g.val()&&(c=g.val().split(",").map(b.trim),b.each(c,function(a,c){a=e.find('option[value="'+c.replace(/"/g,'\\"')+'"]');a.length?a.prop("selected",!0):b("<option selected>").val(c).text(c).appendTo(e)}),e.trigger("change"));this.$hiddenInput=g;g=e.data("select2");this.$container=g.$container;
this.$selection=g.$selection;g.on("results:message",function(a){this.dropdown._resizeDropdown();this.dropdown._positionDropdown()});a.attr("autofocus")&&(e.select2("open"),g.$selection.addClass("is-focused"));a=e.closest(".overlay-container");if(a.length)a.on("overlay:hiding",function(){e.select2("close")});e.on("select2:unselecting",function(a){XF.MenuWatcher.preventDocClick()});e.on("select2:unselect",function(a){setTimeout(function(){XF.MenuWatcher.allowDocClick()},0)});g.$container.on("focusin focusout",
XF.proxy(this,"inputFocusBlur"));e.on("change",XF.proxy(this,"updateInput"));e.closest("form").on("reset",function(){e.val(null).trigger("change")})},prepareAjax:function(a){return{q:a.term}},getAjax:function(a,b,g){return XF.ajax("get",this.options.acUrl,a.data,b)},processAjax:function(a,b){return"object"!=typeof a?{}:a},sortResults:function(a){if(1>=a.length)return a;a.hasOwnProperty(0)&&(a[0].hasOwnProperty("q")||a.push(a.shift()));return a},prepareResults:function(a){a.styledText=a.text;if(a.q){var b=
new RegExp("("+XF.regexQuote(a.q)+")","i");a.styledText=XF.htmlspecialchars(a.styledText).replace(b,"<strong>$1</strong>")}else a.disabled||(a.styledText="<strong>"+XF.htmlspecialchars(a.styledText)+"</strong>");b=a.styledText;a.iconHtml&&(b=a.iconHtml+"&nbsp;"+b);return b},prepareSelection:function(a){return XF.htmlspecialchars(a.text)},inputFocusBlur:function(a){switch(a.type){case "focusout":this.$selection.removeClass("is-focused");break;default:this.$selection.addClass("is-focused")}},updateInput:function(a){a=
b(a.target);var c=this.$hiddenInput;a.val()?c.val(a.val().join(", ")):c.val("")}});XF.TokenInputSelect=XF.Element.newHandler({options:{removeDisabled:!0},init:function(){var a=this,c={width:"100%",containerCssClass:"input",language:XF.TokenInput.Phrases,disabled:this.$target.prop("disabled"),placeholder:this.$target.attr("placeholder"),matcher:function(c,d){c=b.fn.select2.defaults.defaults.matcher(c,d);if(!c)return null;if(a.options.removeDisabled){if(c.disabled)return null;if(c.children){for(d=c.children.length-
1;0<=d;d--)c.children[d].disabled&&c.children.splice(d,1);if(!c.children.length)return null}}return c}};this.$target.on("select:refresh",XF.proxy(this,"refresh")).select2(c)},refresh:function(){var a=this.$target,b=a.data("select2").dataAdapter,d=a.children();a.empty();b.addOptions(d)}});XF.TokenInput.Phrases={errorLoading:function(){return XF.phrase("s2_error_loading")},inputTooLong:function(a){return XF.phrase("s2_input_too_long",{"{count}":a.input.length-a.maximum})},inputTooShort:function(a){return XF.phrase("s2_input_too_short",
{"{count}":a.minimum-a.input.length})},loadingMore:function(){return XF.phrase("s2_loading_more")},maximumSelected:function(a){return XF.phrase("s2_maximum_selected",{"{count}":a.maximum})},noResults:function(){return XF.phrase("s2_no_results")},searching:function(){return XF.phrase("s2_searching")}};XF.Element.register("token-input","XF.TokenInput");XF.Element.register("token-input-select","XF.TokenInputSelect")}(jQuery,window,document);
