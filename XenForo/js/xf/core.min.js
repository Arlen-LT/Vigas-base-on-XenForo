var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,h,k){d instanceof String&&(d=String(d));for(var a=d.length,b=0;b<a;b++){var c=d[b];if(h.call(k,c,b,d))return{i:b,v:c}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,h,k){d!=Array.prototype&&d!=Object.prototype&&(d[h]=k.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,h,k,a){if(h){k=$jscomp.global;d=d.split(".");for(a=0;a<d.length-1;a++){var b=d[a];b in k||(k[b]={});k=k[b]}d=d[d.length-1];a=k[d];h=h(a);h!=a&&null!=h&&$jscomp.defineProperty(k,d,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,k){return $jscomp.findInternal(this,d,k).v}},"es6","es3");$jscomp.polyfill("Array.prototype.fill",function(d){return d?d:function(d,k,a){var b=this.length||0;0>k&&(k=Math.max(0,b+k));if(null==a||a>b)a=b;a=Number(a);0>a&&(a=Math.max(0,b+a));for(k=Number(k||0);k<a;k++)this[k]=d;return this}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(h){return $jscomp.SYMBOL_PREFIX+(h||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(d){var h=0;return $jscomp.iteratorPrototype(function(){return h<d.length?{done:!1,value:d[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();var h=d[Symbol.iterator];return h?h.call(d):$jscomp.arrayIterator(d)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(d){function h(){this.batch_=null}function k(a){return a instanceof b?a:new b(function(b,c){b(a)})}if(d&&!$jscomp.FORCE_POLYFILL_PROMISE)return d;h.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};h.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var a=$jscomp.global.setTimeout;h.prototype.asyncExecuteFunction=function(b){a(b,
0)};h.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};h.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var b=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(g){b.reject(g)}};b.prototype.createResolveAndReject_=
function(){function a(a){return function(g){c||(c=!0,a.call(b,g))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};b.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};b.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(g){this.reject_(g);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};b.prototype.reject_=function(a){this.settle_(2,a)};b.prototype.fulfill_=function(a){this.settle_(1,a)};b.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)c.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var c=new h;b.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};b.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};b.prototype.then=function(a,c){function g(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(v){f(v)}}:
b}var e,f,d=new b(function(a,b){e=a;f=b});this.callWhenSettled_(g(a,e),g(c,f));return d};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.callWhenSettled_=function(a,b){function g(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?c.asyncExecute(g):this.onSettledCallbacks_.push(g)};b.resolve=k;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,
c){for(var g=$jscomp.makeIterator(a),e=g.next();!e.done;e=g.next())k(e.value).callWhenSettled_(b,c)})};b.all=function(a){var c=$jscomp.makeIterator(a),g=c.next();return g.done?k([]):new b(function(a,b){function e(b){return function(c){d[b]=c;f--;0==f&&a(d)}}var d=[],f=0;do d.push(void 0),f++,k(g.value).callWhenSettled_(e(d.length-1),b),g=c.next();while(!g.done)})};return b},"es6","es3");
$jscomp.checkStringArgs=function(d,h,k){if(null==d)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return d+""};
$jscomp.polyfill("String.prototype.repeat",function(d){return d?d:function(d){var h=$jscomp.checkStringArgs(this,null,"repeat");if(0>d||1342177279<d)throw new RangeError("Invalid count value");d|=0;for(var a="";d;)if(d&1&&(a+=h),d>>>=1)h+=h;return a}},"es6","es3");var XF=window.XF||{};void 0===window.jQuery&&(jQuery=$={});
!function(d,h,k){XF.activate?console.error("XF core has been double loaded"):(XF.browser||(XF.browser={browser:"",version:0,os:"",osVersion:null}),function(){var a=function(){var a=k.createElement("fake"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;for(c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}();d.support.transition=a;d.support.transition&&(d.event.special.xfTransitionEnd={bindType:a.end,
delegateType:a.end,handle:function(a){if(d(a.target).is(this))return a.handleObj.handler.apply(this,arguments)}});var b=d("html").attr("dir");a="normal";if(b&&"RTL"==b.toUpperCase()){b=d('<div style="width: 80px; height: 40px; font-size: 30px; overflow: scroll; white-space: nowrap; word-wrap: normal; position: absolute; top: -1000px; visibility: hidden; pointer-events: none">MMMMMMMMMM</div>');var c=b[0];b.appendTo("body");0<c.scrollLeft?a="inverted":(c.scrollLeft=-1,-1==c.scrollLeft&&(a="negative"));
b.remove()}d.support.scrollLeftType=a;d.fn.reverse=[].reverse;d.addEventCapture=function(){var a=d.event.special;return function(b){k.addEventListener&&("string"==typeof b&&(b=[b]),d.each(b,function(b,c){var g=function(a){a=d.event.fix(a);return d.event.dispatch.call(this,a)};a[c]=a[c]||{};a[c].setup||a[c].teardown||d.extend(a[c],{setup:function(){this.addEventListener(c,g,!0)},teardown:function(){this.removeEventListener(c,g,!0)}})}))}}()}(),d.fn.extend({onWithin:function(a,b,c){var f=this;d(k).on(a,
function(a){d(a.target).has(f).length&&(c&&d(k).off(a),b(a))});return this},oneWithin:function(a,b){return this.onWithin(a,b,!0)},onPassive:function(a,b){if("object"==typeof a){for(var c in a)this.onPassive(c,a[c]);return this}if("string"!=typeof a||"function"!=typeof b)return console.warn("$.onPassive failure for %s.on%s, check parameters",this.get(0),a),this;if(-1!==a.indexOf("."))return console.warn("$.onPassive does not support namespaced events %s.on%s",this.get(0),a),!1;XF.Feature.has("passiveeventlisteners")?
this.get(0).addEventListener(a,b,{passive:!0}):this.get(0).addEventListener(a,b);return this},offPassive:function(a,b){this.get(0).removeEventListener(a,b);return this},onPointer:function(a,b){if(d.isPlainObject(a)){for(var c in a)if(a.hasOwnProperty(c))this.onPointer(c,a[c]);return this}"string"===typeof a&&(a=a.split(/\s+/));var f=this,e=function(a){var c=d(this).data("xf-pointer-type");a.xfPointerType=a.pointerType||c||"";b(a)};a.forEach(function(a){f.on(a,e)});this.off("pointerdown.pointer-watcher").on("pointerdown.pointer-watcher",
function(a){d(this).data("xf-pointer-type",a.pointerType)});return this},xfFadeDown:function(a,b){this.filter(":hidden").hide().css("opacity",0);a=a||XF.config.speed.normal;this.find(".is-sticky").addClass("was-sticky").removeClass("is-sticky");this.animate({opacity:1,height:"show",marginTop:"show",marginBottom:"show",paddingTop:"show",paddingBottom:"show"},{duration:a,easing:"swing",complete:function(){d(this).find(".was-sticky").addClass("is-sticky").removeClass("was-sticky");b&&b();XF.layoutChange()}});
return this},xfFadeUp:function(a,b){a=a||XF.config.speed.normal;this.find(".is-sticky").addClass("was-sticky").removeClass("is-sticky");this.animate({opacity:0,height:"hide",marginTop:"hide",marginBottom:"hide",paddingTop:"hide",paddingBottom:"hide"},{duration:a,easing:"swing",complete:function(){d(this).find(".was-sticky").addClass("is-sticky").removeClass("was-sticky");b&&b();XF.layoutChange()}});return this},xfUniqueId:function(){var a=this.attr("id");a||(a="js-XFUniqueId"+XF.getUniqueCounter(),
this.attr("id",a));return a},findExtended:function(a){var b;if("string"===typeof a&&(b=a.match(/^<([^|]+)(\|([\s\S]+))?$/))){a=d.trim(b[1]);var c,f,e={up:"parent",next:"next",prev:"prev"},g=this;do if(c=a.match(/^:(up|next|prev)(\((\d+)\))?/)){c[2]||(c[3]=1);var l=e[c[1]];for(f=0;f<c[3];f++)(g=g[l]())||(g=d());a=d.trim(a.substr(c[0].length))}while(c);a.length&&(g=g.closest(a));g.length||(g=d());a=b[2]?d.trim(b[3]):"";return a.length?g.find(a):g}return this._find(a)},dimensions:function(a,b){var c=
this.offset();c={top:c.top,left:c.left};b=b?!0:!1;c.width=a?this.outerWidth(b):this.width();c.height=a?this.outerHeight(b):this.height();c.right=c.left+c.width;c.bottom=c.top+c.height;return c},viewport:function(a,b){a={width:a?this.outerWidth(b):this.width(),height:a?this.outerHeight(b):this.height(),left:this.scrollLeft(),top:this.scrollTop(),right:0,bottom:0,docWidth:d(k).width(),docHeight:d(k).height()};a.bottom=a.top+a.height;a.right=a.left+a.width;return a},hasFixableParent:function(){var a=
!1;this.parents().each(function(){var b=d(this);switch(b.css("position")){case "fixed":case "sticky":case "-webkit-sticky":return a=b,!1}if(b.data("sticky_kit"))return a=b,!1});return a},hasFixedParent:function(){var a=!1;this.parents().each(function(){var b=d(this);switch(b.css("position")){case "fixed":return a=b,!1;case "sticky":case "-webkit-sticky":var c=b.dimensions(!0),f=d(h).viewport(),e=b.css("top"),g=b.css("bottom");if("auto"!==e&&(e=c.top-f.top-parseInt(e,10),.5>=e&&-.5<=e)||"auto"!==g&&
(e=c.bottom-f.bottom-parseInt(g,10),.5>=e&&-.5<=e))return a=b,!1}});return a},onTransitionEnd:function(a,b){var c=!1,d=this;this.one("xfTransitionEnd",function(){if(!c)return c=!0,b.apply(this,arguments)});setTimeout(function(){c||d.trigger("xfTransitionEnd")},a+10);return this},autofocus:function(){var a=d(this);XF.isIOS()?a.is(":focus")||(a.addClass("is-focused"),a.on("blur",function(){a.removeClass("is-focused")})):a.focus();return this},normalizedScrollLeft:function(a){var b=d.support.scrollLeftType;
if("undefined"!==typeof a){for(var c=0;c<this.length;c++){var f=this[c],e=a;switch(b){case "negative":e=0<e?-e:0;break;case "inverted":e=f.scrollWidth-f.offsetWidth-e}f.scrollLeft=e}return this}a=this[0];if(!a)return 0;c=a.scrollLeft;switch(b){case "negative":return 0>c?-c:0;case "inverted":return b=a.scrollWidth-c-a.offsetWidth,.5>b?0:b;default:return c}},focusNext:function(){var a=d('input:not([type="hidden"]), select, textarea, a, button').filter(":visible");return a.eq(a.index(this)+1).focus()},
retinaFix:function(){if(2<=h.devicePixelRatio)this.find("img[srcset]").one("load",function(a){d(this).prop("srcset",d(this).attr("srcset"))});return this}}),function(){function a(a){if(!d.support.transition)return 0;var b=a[0];if(!(b&&b instanceof h.Element))return 0;a=a.css("transition-duration");b=0;a&&a.match(/^(\+|-|)([0-9]*\.[0-9]+|[0-9]+)(ms|s)/i)&&(b=("-"==RegExp.$1?-1:1)*parseFloat(RegExp.$2)*("ms"==RegExp.$3.toLowerCase()?1:1E3));return b}function b(a,b,c){var g=[];d.isFunction(b)&&(b=b.call(a[0],
0,a[0].className));b=d.trim(b).split(/\s+/);a=" "+a[0].className+" ";for(var e,f=0;f<b.length;f++)((e=0<=a.indexOf(" "+b[f]+" "))&&!c||!e&&c)&&g.push(b[f]);return g.join(" ")}function c(c,g,l,m,n){n=n?0:a(c);var e=g?"addClass":"removeClass",h=g?"removeClass":"addClass";g=b(c,l,g?!0:!1);var p=c[0],k=function(){m&&setTimeout(function(){m.call(p,d.Event("xfTransitionEnd"))},0)};if(g.length)if(0>=n)c[e](g),k();else{c.hasClass("is-transitioning")&&c.trigger("xfTransitionEnd");c.addClass("is-transitioning");
if(c.css("transition-property").match(/(^|\s|,)-xf-(width|height)($|\s|,)/)){k=RegExp.$2;var t=f[k],A=c.css(t),B=A[k],z="transition."+k,q=c.data(z),w=p.style,y=w.transition||w["-webkit-transition"]||w["-moz-transition"]||w["-o-transition"]||"",u;if(void 0===q)for(q={},u=0;u<t.length;u++)q[t[u]]=w[t[u]]||"";if(0==c[k]())for(u in B="0",A)A.hasOwnProperty(u)&&(A[u]="0");c.data(z,q).css("transition","none")[e](g);t=c.css(t);q=t[k];if(0==c[k]())for(u in q="0",t)t.hasOwnProperty(u)&&(t[u]="0");c[h](g);
if(B!=q){var C=m;c.css(A);p.offsetWidth;c.css("transition",y).css(t);m=function(){c.css(c.data(z)).removeData(z);C&&C.apply(this,arguments)}}else c.css("transition",y)}c.onTransitionEnd(n,function(){c.removeClass("is-transitioning");m&&m.apply(this,arguments)});c[e](l)}else k()}var f={height:"height padding-top padding-bottom margin-top margin-bottom border-top-width border-bottom-width".split(" "),width:"width padding-left padding-right margin-left margin-right border-right-width border-left-width".split(" ")};
d.fn.addClassTransitioned=function(a,b,f){for(var g=this.length,e=0;e<g;e++)c(d(this[e]),!0,a,b,f);return this};d.fn.removeClassTransitioned=function(a,b,f){for(var g=this.length,e=0;e<g;e++)c(d(this[e]),!1,a,b,f);return this};d.fn.toggleClassTransitioned=function(a,b,f,m){"boolean"!==typeof b&&"undefined"===typeof f&&(f=b,b=null);for(var g="boolean"===typeof b,e=this.length,l=0;l<e;l++){var h=d(this[l]);var k=g?b:h.hasClass(a)?!1:!0;c(h,k,a,f,m)}return this}}(),d.extend(XF,{config:{userId:null,enablePush:!1,
skipServiceWorkerRegistration:!1,skipPushNotificationSubscription:!1,skipPushNotificationCta:!1,pushAppServerKey:null,csrf:d("html").data("csrf"),time:{now:0,today:0,todayDow:0,tomorrow:0,yesterday:0,week:0},cookie:{path:"/",domain:"",prefix:"xf_"},url:{fullBase:"/",basePath:"/",css:"",keepAlive:""},css:{},js:{},jsState:{},speed:{xxfast:50,xfast:100,fast:200,normal:400,slow:600},job:{manualUrl:""},borderSizeFeature:"3px",fontAwesomeWeight:"r",enableRtnProtect:!0,enableFormSubmitSticky:!0,visitorCounts:{conversations_unread:0,
alerts_unviewed:0,total_unread:0,title_count:!1,icon_indicator:!1},uploadMaxFilesize:null,allowedVideoExtensions:[],allowedAudioExtensions:[],shortcodeToEmoji:!0,publicMetadataLogoUrl:"",publicPushBadgeUrl:""},debug:{disableAjaxSubmit:!1},counter:1,pageDisplayTime:null,phrases:{},getApp:function(){return d("html").data("app")||null},getKeyboardInputs:function(){return"input:not([type=radio], [type=checkbox], [type=submit], [type=reset]), textarea"},onPageLoad:function(){d(k).trigger("xf:page-load-start");
XF.NavDeviceWatcher.initialize();XF.ActionIndicator.initialize();XF.DynamicDate.initialize();XF.KeepAlive.initialize();XF.LinkWatcher.initLinkProxy();XF.LinkWatcher.initExternalWatcher();XF.NoticeWatcher.initialize();XF.ExpandableContent.watch();XF.ScrollButtons.initialize();XF.KeyboardShortcuts.initialize();XF.FormInputValidation.initialize();XF.PWA.initialize();XF.Push.initialize();XF.IgnoreWatcher.initializeHash();XF.BrowserWarning.display();XF.History.initialize();XF.config.jsState=XF.applyJsState({},
XF.config.jsState);XF.activate(k);d(k).on("ajax:complete",function(a,b,c){(a=b.responseJSON)&&a.visitor&&XF.updateVisitorCounts(a.visitor,!0)});d(k).on("ajax:before-success",function(a,b,c,d){(b=d.responseJSON)&&b&&b.job&&(a=b.job,a.manual&&XF.JobRunner.runManual(a.manual),a.autoBlocking?XF.JobRunner.runAutoBlocking(a.autoBlocking,a.autoBlockingMessage):a.auto&&setTimeout(XF.JobRunner.runAuto,0))});d(k).on("keyup","a:not([href])",function(a){"Enter"==a.key&&d(a.currentTarget).click()});d("html[data-run-jobs]").length&&
setTimeout(XF.JobRunner.runAuto,100);XF.updateVisitorCountsOnLoad(XF.config.visitorCounts);XF.CrossTab.on("visitorCounts",function(a){XF.updateVisitorCounts(a,!1)});XF.pageLoadScrollFix();setTimeout(function(){d("[data-load-auto-click]").first().click()},100);d(k).trigger("xf:page-load-complete")},addExtraPhrases:function(a){d(a).find("script.js-extraPhrases").each(function(){var a=d(this);try{var c=d.parseJSON(a.html())||{};d.extend(XF.phrases,c)}catch(f){console.error(f)}a.remove()})},phrase:function(a,
b,c){var d=XF.phrases[a];d&&b&&(d=XF.stringTranslate(d,b));return d||c||a},_isRtl:null,isRtl:function(){if(null===XF._isRtl){var a=d("html").attr("dir");XF._isRtl=a&&"RTL"==a.toUpperCase()}return XF._isRtl},rtlFlipKeyword:function(a){if(!XF.isRtl())return a;switch(a.toLowerCase()){case "left":return"right";case "right":return"left";default:return a}},isMac:function(){return-1!=navigator.userAgent.indexOf("Mac OS")},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!h.MSStream},
isIE:function(){var a=navigator.userAgent;return 0<a.indexOf("MSIE ")||0<a.indexOf("Trident/")},log:function(){console.log&&console.log.apply&&console.log.apply(console,arguments)},findRelativeIf:function(a,b){if(!a)throw Error("No selector provided");var c;if(c=a.match(/^(<|>|\|)/)){if("<"==c[1])return b.findExtended(a);"|"==c[1]&&(a=a.substr(1));return b.find(a)}return d(a)},isElementVisible:function(a){a=a[0].getBoundingClientRect();return 0<=a.top&&0<=a.left&&a.bottom<=d(h).height()&&a.right<=
d(h).width()},layoutChange:function(){XF._layoutChangeTriggered||(XF._layoutChangeTriggered=!0,setTimeout(function(){XF._layoutChangeTriggered=!1;d(k.body).trigger("sticky_kit:recalc").trigger("xf:layout")},0))},_layoutChangeTriggered:!1,updateAvatars:function(a,b,c){d(".avatar").each(function(){var f=d(this),e=f.find("img, span").first(),g="avatar-u"+a+"-",l=f.hasClass("avatar--updateLink")?f.find(".avatar-update"):null;if((c||!e.hasClass(".js-croppedAvatar"))&&e.is('[class^="'+g+'"]')){if(e.hasClass(g+
"s"))e=d(b.s);else if(e.hasClass(g+"m"))e=d(b.m);else if(e.hasClass(g+"l"))e=d(b.l);else if(e.hasClass(g+"o"))e=d(b.o);else return;f.html(e.html());e.hasClass("avatar--default")?(f.addClass("avatar--default"),e.hasClass("avatar--default--dynamic")?f.addClass("avatar--default--dynamic"):e.hasClass("avatar--default--text")?f.addClass("avatar--default--text"):e.hasClass("avatar--default--image")&&f.addClass("avatar--default--image")):f.removeClass("avatar--default avatar--default--dynamic avatar--default--text avatar--default--image");
f.attr("style",e.attr("style"));l&&f.append(l)}})},updateVisitorCounts:function(a,b,c){a&&"public"==XF.getApp()&&(XF.badgeCounterUpdate(d(".js-badge--conversations"),a.conversations_unread),XF.badgeCounterUpdate(d(".js-badge--alerts"),a.alerts_unviewed),XF.config.visitorCounts.title_count&&XF.pageTitleCounterUpdate(a.total_unread),XF.config.visitorCounts.icon_indicator&&XF.faviconUpdate(a.total_unread),b&&(XF.appBadgeUpdate(a.total_unread),XF.CrossTab.trigger("visitorCounts",a),XF.LocalStorage.setJson("visitorCounts",
{time:c||Math.floor((new Date).getTime()/1E3)-1,conversations_unread:a.conversations_unread,alerts_unviewed:a.alerts_unviewed,total_unread:a.total_unread})))},updateVisitorCountsOnLoad:function(a){var b=XF.getLocalLoadTime(),c=XF.LocalStorage.getJson("visitorCounts");c&&c.time&&c.time>b&&(a.conversations_unread=c.conversations_unread,a.alerts_unviewed=c.alerts_unviewed,a.total_unread=c.total_unread);XF.updateVisitorCounts(a,!0,b)},badgeCounterUpdate:function(a,b){a.length&&(a.attr("data-badge",b),
"0"!=String(b)?a.addClass("badgeContainer--highlighted"):a.removeClass("badgeContainer--highlighted"))},shouldCountBeShown:function(a){return 0<parseInt(a.replace(/[,. ]/g,""))},pageTitleCache:"",pageTitleCounterUpdate:function(a){var b=k.title;""===XF.pageTitleCache&&(XF.pageTitleCache=b);b!==XF.pageTitleCache&&"("===b.charAt(0)&&(b=XF.pageTitleCache);a=(this.shouldCountBeShown(a)?"("+a+") ":"")+b;a!=k.title&&(k.title=a)},favIconAlertShown:!1,faviconUpdate:function(a){var b=this.shouldCountBeShown(a);
if(b!==XF.favIconAlertShown){var c=d('link[rel~="icon"]');if(c.length){XF.favIconAlertShown=b;var f=this;c.each(function(b,c){var g=d(c);b=g.attr("href");c=g.data("original-href");f.shouldCountBeShown(a)?(c||g.data("original-href",b),d("<img />").on("load",function(){var a=XF.faviconDraw(this);a&&g.attr("href",a)}).attr("src",b)):c&&g.attr("href",c).removeData("original-href")})}}},faviconDraw:function(a){var b=a.naturalWidth,c=a.naturalHeight;c=d("<canvas />").attr({width:b,height:c});var f=c[0].getContext("2d"),
e=b/(32/6),g=2*Math.PI;f.drawImage(a,0,0);f.beginPath();f.arc(e,e,e,0,g,!1);f.fillStyle="#E03030";f.fill();f.lineWidth=b/16;f.strokeStyle="#EAEAEA";f.stroke();f.closePath();try{return c[0].toDataURL("image/png")}catch(l){return null}},appBadgeUpdate:function(a){"setAppBadge"in navigator&&!navigator.webdriver&&!navigator.userAgent.match(/Chrome-Lighthouse|Googlebot|AdsBot-Google|Mediapartners-Google/i)&&(a=parseInt(a.replace(/[,. ]/g,"")),navigator.setAppBadge(a))},unparseBbCode:function(a){var b=
d(k.createElement("div"));b.html(a);b.find(".js-noSelectToQuote").each(function(){d(this).remove()});d.each(["B","I","U","S"],function(a,f){b.find(f).each(function(){d(this).replaceWith("["+f+"]"+d(this).html()+"[/"+f+"]")})});b.find(".bbCodeBlock--quote").each(function(){var a=d(this),b=a.find(".bbCodeBlock-expandContent");b.length?a.replaceWith("<div>[QUOTE]"+b.html()+"[/QUOTE]</div>"):b.find(".bbCodeBlock-expand").remove()});b.find(".bbCodeBlock--code").each(function(){var a=d(this);if(!a.find(".bbCodeCode"))return!0;
var b=a.find(".bbCodeCode code");if(!b.length)return!0;var e=b.attr("class");e=(e=e?e.match(/language-(\S+)/):null)?e[1]:null;b.removeAttr("class");a.replaceWith(b.first().attr("data-language",e||"none"))});b.find(".bbCodeBlock--unfurl").each(function(){var a=d(this).data("url");d(this).replaceWith("[URL unfurl=true]"+a+"[/URL]")});b.find('div[style*="text-align"]').each(function(){var a=d(this).css("text-align").toUpperCase();d(this).replaceWith("["+a+"]"+d(this).html()+"[/"+a+"]")});b.find(".bbCodeSpoiler").each(function(){var a=
"";var b=d(this).find(".bbCodeSpoiler-button");if(b.length){var e=d(this).find(".bbCodeSpoiler-content").html();b=b.find(".bbCodeSpoiler-button-title");b.length&&(a='="'+b.text()+'"');d(this).replaceWith("[SPOILER"+a+"]"+e+"[/SPOILER]")}});b.find(".bbCodeInlineSpoiler").each(function(){var a=d(this).html();d(this).replaceWith("[ISPOILER]"+a+"[/ISPOILER]")});return b.html()},hideOverlays:function(){d.each(XF.Overlay.cache,function(a,b){b.hide()})},hideTooltips:function(){d.each(XF.TooltipTrigger.cache,
function(a,b){b.hide()})},hideParentOverlay:function(a){a=a.closest(".overlay-container");a.length&&a.data("overlay")&&a.data("overlay").hide()},getStickyHeaderOffset:function(){var a,b=0;for(a=0;a<XF.StickyHeader.cache.length;a++){var c=XF.StickyHeader.cache[a];c.$target.hasClass(c.options.stickyClass)&&(b+=c.$target.outerHeight())}return b},loadedScripts:{},loadScript:function(a,b){if(XF.loadedScripts.hasOwnProperty(a))return!1;XF.loadedScripts[a]=!0;return d.ajax({url:a,dataType:"script",cache:!0,
global:!1,success:b})},loadScripts:function(a,b){function c(){m--;0===m&&b&&b()}function f(){for(var a;n[0]&&"loaded"==n[0].readyState;)a=n.shift(),a.onreadystatechange=null,a.onerror=null,l.appendChild(a),c()}var e=k.scripts[0],g="async"in e;e=e.readyState;var l=k.head,m=0,n=[],h;for(h in a)if(a.hasOwnProperty(h)){var r=a[h];XF.loadedScripts[r]||(XF.loadedScripts[r]=!0,m++,g?function(a){var b=d("<script>").prop({src:a,async:!1});b.on("load error",function(a){b.off("load error");c()});l.appendChild(b[0])}(r):
e?function(a){var b=k.createElement("script");n.push(b);b.onreadystatechange=f;b.onerror=function(){b.onreadystatechange=null;b.onerror=null;c()};b.src=a}(r):d.ajax({url:r,dataType:"script",cache:!0,global:!1}).always(c))}!m&&b&&b()},ajax:function(a,b,c,f,e){"function"==typeof c&&void 0===f&&(f=c,c={});c=c||{};var g=!0,l=!0,m=!0;e&&(e.skipDefault&&(l=g=!1,delete e.skipDefault),e.skipDefaultSuccessError&&(l=!1,delete e.skipDefaultSuccessError),e.skipDefaultSuccess&&(g=!1,delete e.skipDefaultSuccess),
e.skipError&&(m=!1,delete e.skipError));var n=function(a,b,c){d(k).trigger("ajax:before-success",[a,b,c]);l&&XF.defaultAjaxSuccessError(a,b,c)||g&&XF.defaultAjaxSuccess(a,b,c)||f&&f(a,b,c)},x=function(a,b,c){if(a.readyState)try{var g=d.parseJSON(a.responseText);n(g,"",a)}catch(B){XF.defaultAjaxError(a,b,c)}};c=XF.dataPush(c,"_xfRequestUri",h.location.pathname+h.location.search);c=XF.dataPush(c,"_xfWithData",1);XF.config.csrf&&(c=XF.dataPush(c,"_xfToken",XF.config.csrf));var r=h.FormData&&c instanceof
FormData;a=d.extend(!0,{cache:!0,data:c||{},dataType:"json",beforeSend:function(a,b){d(k).trigger("ajax:send",[a,b])},error:m?x:null,success:n,complete:function(a,b){d(k).trigger("ajax:complete",[a,b])},timeout:"get"===a?3E4:6E4,type:a,url:b,processData:r?!1:!0},e);r&&(a.contentType=!1);switch(a.dataType){case "html":case "json":case "xml":a.data=XF.dataPush(a.data,"_xfResponseType",a.dataType)}"json"!=a.dataType&&(g=!1);return d.ajax(a)},dataPush:function(a,b,c){a&&"string"!=typeof a?void 0!==a[0]?
a.push({name:b,value:c}):h.FormData&&a instanceof FormData?a.append(b,c):a[b]=c:(a=String(a),a+="&"+encodeURIComponent(b)+"="+encodeURIComponent(c));return a},defaultAjaxSuccessError:function(a,b,c){if("object"!=typeof a)return XF.alert("Response was not JSON."),!0;a.html&&a.html.templateErrors&&(b="Errors were triggered when rendering this template:",a.html.templateErrorDetails&&(b+="\n* "+a.html.templateErrorDetails.join("\n* ")),console.error(b));return a.errorHtml?(XF.setupHtmlInsert(a.errorHtml,
function(a,b){b=b.h1||b.title||XF.phrase("oops_we_ran_into_some_problems");XF.overlayMessage(b,a)}),!0):a.errors?(XF.alert(a.errors),!0):a.exception?(XF.alert(a.exception),!0):!1},defaultAjaxSuccess:function(a,b,c){a&&"ok"==a.status&&a.message&&XF.flashMessage(a.message,3E3);return!1},defaultAjaxError:function(a,b,c){switch(b){case "abort":return;case "timeout":XF.alert(XF.phrase("server_did_not_respond_in_time_try_again"));return;case "notmodified":case "error":if(!a||!a.responseText)return}console.error("PHP: "+
a.responseText);XF.alert(XF.phrase("oops_we_ran_into_some_problems_more_details_console"))},activate:function(a){XF.addExtraPhrases(a);XF.IgnoreWatcher.refresh(a);XF.Element.initialize(a);XF.DynamicDate.refresh(a);XF.ExpandableContent.checkSizing(a);XF.UnfurlLoader.activateContainer(a);XF.KeyboardShortcuts.initializeElements(a);XF.FormInputValidation.initializeElements(a);var b=a instanceof d?a.get(0):a;h.FB&&setTimeout(function(){FB.XFBML.parse(b)},0);d(k).trigger("xf:reinit",[a])},getDefaultFormData:function(a,
b,c,f){var e;b&&b.length&&b.attr("name")&&(e=b.attr("name"));c&&"multipart/form-data"===a.attr("enctype")&&console.error("JSON serialized forms do not support the file upload-style enctype.");if(h.FormData&&!c){var g=new FormData(a[0]);e&&g.append(e,b.attr("value"));a.find('input[type="file"]').each(function(){var a=d(this);if(0===a.prop("files").length)try{g.delete(a.attr("name"))}catch(p){}})}else{if(c){a=a.is("form")?d(a[0].elements):a;var l,m=[],n=[];if(f){"string"===typeof f&&(f=f.split(","));
var k=[];d.each(f,function(a,b){"number"===typeof a?k.push(XF.regexQuote(d.trim(b))):k.push(XF.regexQuote(d.trim(a)))});k.length&&(l=new RegExp("^("+k.join("|")+")(\\[|$)"))}a.each(function(a,b){(a=b.name)&&"_xf"!==a.substring(0,3)?!l||l.test(a)?m.push(b):n.push(b):n.push(b)});g=d(n).serializeArray();f=d(m).serializeJSON();g.unshift({name:c,value:JSON.stringify(f)})}else g=a.serializeArray();e&&g.push({name:e,value:b.attr("value")})}return g},scriptMatchRegex:/<script([^>]*)>([\s\S]*?)<\/script>/ig,
setupHtmlInsert:function(a,b,c){if("string"===typeof a||a instanceof d)a={content:a};if("object"==typeof a&&a.content){var f=arguments;XF.Loader.load(a.js,a.css,function(){var c,g=a.jsInline||[],l=a.content,m="string"==typeof l,n=f[2]?!0:!1;if(a.cssInline)for(c=0;c<a.cssInline.length;c++)d("<style>"+a.cssInline[c]+"</style>").appendTo("head");if(m){var h;l=d.trim(l);if(!n)for(;c=XF.scriptMatchRegex.exec(l);){var k=!1;if(h=c[1].match(/(^|\s)type=("|'|)([^"' ;]+)/))switch(h[3].toLowerCase()){case "text/javascript":case "text/ecmascript":case "application/javascript":case "application/ecmascript":k=
!0}else k=!0;k&&(g.push(c[2]),l=l.replace(c[0],""))}l=l.replace(/<noscript>([\s\S]*?)<\/noscript>/ig,"")}var p=d(m?d.parseHTML(l,null,n):l);p.retinaFix();p.find("noscript").empty().remove();if(b instanceof d){var v=b;b=function(a){v.html(a)}}if("function"!==typeof b)console.error("onReady was not a function");else{var t=!1;l=function(b){if(!t){t=!0;for(var c=0;c<g.length;c++)d.globalEval(g[c]);a.jsState&&(XF.config.jsState=XF.applyJsState(XF.config.jsState,a.jsState));b||XF.activate(p)}};!1!==b(p,
a,l)&&l()}})}else console.error("Was not provided an object or HTML content")},alert:function(a,b,c,f){var e=a;"object"==typeof a&&(e="<ul>",d.each(a,function(a,b){e+="<li>"+b+"</li>"}),e+="</ul>",e='<div class="blockMessage">'+e+"</div>");b||(b="error");if(!c)switch(b){case "error":c=XF.phrase("oops_we_ran_into_some_problems");break;default:c=""}return XF.overlayMessage(c,e)},getOverlayHtml:function(a){var b={dismissible:!0,title:null};d.isPlainObject(a)&&(b=d.extend({},b,a),a.html&&(a=a.html));
if("string"==typeof a)a=d(d.parseHTML(a));else if(!(a instanceof d))throw Error("Can only create an overlay with html provided as a string or jQuery object");if(!a.is(".overlay")){var c=b.title;if(!c){var f=a.find(".overlay-title");f.length&&(c=f.contents(),f.remove())}c||(c=XF.htmlspecialchars(d("title").text()));f=a.find(".overlay-content");f.length&&(a=f);f=d('<div class="overlay" tabindex="-1"><div class="overlay-title"></div><div class="overlay-content"></div></div>');var e=f.find(".overlay-title");
e.html(c);b.dismissible&&e.prepend('<a class="overlay-titleCloser js-overlayClose" role="button" tabindex="0" aria-label="'+XF.phrase("close")+'"></a>');f.find(".overlay-content").html(a);a=f}a.appendTo("body");return a},createMultiBar:function(a,b,c,d){},getMultiBarHtml:function(a){var b={dismissible:!0,title:null};d.isPlainObject(a)&&(d.extend({},b,a),a.html&&(a=a.html));if("string"==typeof a)a=d(d.parseHTML(a));else if(!(a instanceof d))throw Error("Can only create an action bar with html provided as a string or jQuery object");
b=d('<div class="multiBar" tabindex="-1"><div class="multiBar-inner"><span>Hello there.</span></div></div>');b.find(".multiBar-inner").html(a);b.appendTo("body");return b},overlayMessage:function(a,b){if("string"==typeof b)b=d(d.parseHTML(b));else if(!(b instanceof d))throw Error("Can only create an overlay with html provided as a string or jQuery object");b.is(".block, .blockMessage")||b.find(".block, .blockMessage").length||(b=d('<div class="blockMessage" />').html(b));b=XF.getOverlayHtml({title:a,
html:b});return XF.showOverlay(b,{role:"alertdialog"})},flashMessage:function(a,b,c){var f=d('<div class="flashMessage"><div class="flashMessage-content"></div></div>');f.find(".flashMessage-content").html(a);f.appendTo("body").addClassTransitioned("is-active");setTimeout(function(){f.removeClassTransitioned("is-active",function(){f.remove();c&&c()})},Math.max(500,b))},htmlspecialchars:function(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},
regexQuote:function(a){return(a+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}=!<>\|:])/g,"\\$1")},stringTranslate:function(a,b){a=a.toString();for(var c in b)if(b.hasOwnProperty(c)){var d=new RegExp(XF.regexQuote(c,"g"));a=a.replace(d,b[c])}return a},stringHashCode:function(a){var b=0,c;if(0===a.length)return b;var d=0;for(c=a.length;d<c;d++){var e=a.charCodeAt(d);b=(b<<5)-b+e;b|=0}return b},getUniqueCounter:function(){var a=XF.counter;XF.counter++;return a},canonicalizeUrl:function(a){if(a.match(/^[a-z]+:/i))return a;
if(0==a.indexOf("/")){var b;return(b=XF.config.url.fullBase.match(/^([a-z]+:(\/\/)?[^\/]+)\//i))?b[1]+a:a}return XF.config.url.fullBase+a},isRedirecting:!1,redirect:function(a){XF.isRedirecting=!0;if(XF.JobRunner.isBlockingJobRunning())return d(k).one("job:blocking-complete",function(){XF.redirect(a)}),!1;a=XF.canonicalizeUrl(a);var b=h.location;if(a==b.href)b.reload(!0);else{h.location=a;var c=a.split("#"),f=b.href.split("#");c[1]&&c[0]==f[0]&&b.reload(!0)}return!0},getAutoCompleteUrl:function(){return"admin"==
XF.getApp()?XF.canonicalizeUrl("admin.php?users/find"):XF.canonicalizeUrl("index.php?members/find")},applyDataOptions:function(a,b,c){var f={},e;for(e in a)if(a.hasOwnProperty(e)&&(f[e]=a[e],b.hasOwnProperty(e))){var g=b[e];var l=typeof g;var m=!0;switch(typeof f[e]){case "string":"string"!=l&&(g=String(g));break;case "number":"number"!=l&&(g=Number(g),isNaN(g)&&(m=!1));break;case "boolean":if("boolean"!=l)switch(g){case "true":case "yes":case "on":case "1":case 1:g=!0;break;default:g=!1}}m&&(f[e]=
g)}d.isPlainObject(c)&&(f=d.extend(f,c));return f},watchInputChangeDelayed:function(a,b,c){var f=d(a),e=f.val(),g;c=c||200;f.onPassive({keyup:function(){clearTimeout(g);g=setTimeout(function(){var a=f.val();a!=e&&(e=a,b())},c)},paste:function(){setTimeout(function(){f.trigger("keyup")},0)}})},insertIntoEditor:function(a,b,c,d){return XF.modifyEditorContent(a,function(a){a.insertContent(b)},function(a){XF.insertIntoTextBox(a,c)},d)},replaceEditorContent:function(a,b,c,d){return XF.modifyEditorContent(a,
function(a){a.replaceContent(b)},function(a){XF.replaceIntoTextBox(a,c)},d)},clearEditorContent:function(a,b){b=XF.replaceEditorContent(a,"","",b);a.trigger("draft:sync");return b},modifyEditorContent:function(a,b,c,f){a=XF.getEditorInContainer(a,f);return a?XF.Editor&&a instanceof XF.Editor?(a.isBbCodeView()?(b=a.ed.bbCode.getTextArea(),c(b),b.trigger("autosize")):b(a),!0):a instanceof d&&a.is("textarea")?(c(a),a.trigger("autosize"),!0):!1:!1},getEditorInContainer:function(a,b){if(a.is(".js-editor")){if(b&&
a.is(b))return null;b=a}else{a=a.find(".js-editor");b&&(a=a.not(b));if(!a.length)return null;b=a.first()}return(a=XF.Element.getHandler(b,"editor"))?a:b.is("textarea")?b:null},focusEditor:function(a,b){a=XF.getEditorInContainer(a,b);return a?XF.Editor&&a instanceof XF.Editor?(a.isInitialized()&&a.scrollToCursor(),!0):a instanceof d&&a.is("textarea")?(a.autofocus(),!0):!1:!1},insertIntoTextBox:function(a,b){var c=a[0],d=c.scrollTop,e=c.selectionStart,g=c.selectionEnd,l=a.val(),m=l.substring(0,e);g=
l.substring(g,l.length);a.val(m+b+g).trigger("autosize");c.selectionStart=c.selectionEnd=e+b.length;c.scrollTop=d;a.autofocus()},replaceIntoTextBox:function(a,b){a.val(b).trigger("autosize")},isElementWithinDraftForm:function(a){a=a.is("form")?a:a.closest("form");return a.length&&a.is("[data-xf-init~=draft]")},logRecentEmojiUsage:function(a){a=d.trim(a);var b=XF.Feature.has("hiddenscroll")?12:11,c=XF.Cookie.get("emoji_usage");c=c?c.split(","):[];var f=c.indexOf(a);-1!==f&&c.splice(f,1);c.push(a);
c.length>b&&(c=c.reverse().slice(0,b).reverse());XF.Cookie.set("emoji_usage",c.join(","),new Date((new Date).setFullYear((new Date).getFullYear()+1)));d(k).trigger("recent-emoji:logged");return c},getRecentEmojiUsage:function(){var a=XF.Cookie.get("emoji_usage");return(a?a.split(","):[]).reverse()},getFixedOffsetParent:function(a){do{if("fixed"==a.css("position"))return a;a=a.parent()}while(a[0]&&1===a[0].nodeType);return d(k.documentElement)},getFixedOffset:function(a){var b=a.offset(),c=XF.getFixedOffsetParent(a);
if(a.is("html"))return b;a=c.offset();return{top:b.top-a.top,left:b.left-a.left}},autoFocusWithin:function(a,b,c){var f=a.find(b||"[autofocus]");f.length||(!f.length&&XF.NavDeviceWatcher.isKeyboardNav()&&(f=a.find("a, button, :input, [tabindex]").filter(":visible").not(":disabled, [data-no-auto-focus]").first()),f.length||(b=a.is("form:not([data-no-auto-focus])")?a:a.find("form:not([data-no-auto-focus])").first(),b.length&&(f=b.find(":input, button").filter(":visible").not(":disabled, .select2-hidden-accessible").first())),
!f.length&&c&&c.length&&(f=c),f.length||(a.attr("tabindex","-1"),f=a));f=f.first();a=[];c=f[0].parentNode;do a.push({el:c,left:c.scrollLeft,top:c.scrollTop});while(c=c.parentNode);f.on("focus",function(){d(h).on("resize",function(){setTimeout(function(){XF.isElementVisible(f)||(f.get(0).scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),d(h).off("resize"))},50)})});f.first().autofocus();for(b=0;b<a.length;b++)c=a[b].el,c.scrollLeft!=a[b].left&&(c.scrollLeft=a[b].left),c.scrollTop!=a[b].top&&
(c.scrollTop=a[b].top)},bottomFix:function(a){var b=d(".js-bottomFixTarget").first();b?b.append(a):d(a).css({position:"fixed",bottom:0}).appendTo("body")},addFixedMessage:function(a,b){var c=d(d.parseHTML('<div class="fixedMessageBar"><div class="fixedMessageBar-inner"><div class="fixedMessageBar-message"></div><a class="fixedMessageBar-close" data-close="true" role="button" tabindex="0" aria-label="'+XF.phrase("close")+'"></a></div></div>'));c.find(".fixedMessageBar-message").html(a);b&&(b.class&&
(c.addClass(b.class),delete b.class),c.attr(b));c.on("click","[data-close]",function(){c.removeClassTransitioned("is-active",function(){c.remove()})});XF.bottomFix(c);c.addClassTransitioned("is-active")},_measureScrollBar:null,measureScrollBar:function(a,b){b="height"==b||"h"==b?"h":"w";if(a||null===XF._measureScrollBar){var c=d('<div class="scrollMeasure" />');c.appendTo(a||"body");var f=c[0];f={w:f.offsetWidth-f.clientWidth,h:f.offsetHeight-f.clientHeight};c.remove();a||(XF._measureScrollBar=f);
return f[b]}return XF._measureScrollBar[b]},windowHeight:function(){return XF.browser.ios||XF.browser.android?h.innerHeight:d(h).height()},pageLoadScrollFix:function(){if(h.location.hash){var a=!1,b=function(){if(!a){var b=h.location.hash.replace(/[^a-zA-Z0-9_-]/g,"");b=b?d("#"+b):d();b.length&&b.get(0).scrollIntoView(!0)}};"complete"==k.readyState?setTimeout(b,0):(setTimeout(function(){d(h).one("scroll",function(b){a=!0})},100),d(h).one("load",b))}},applyJsState:function(a,b){a=a||{};if(!b)return a;
for(var c in b)b.hasOwnProperty(c)&&!a[c]&&XF.jsStates.hasOwnProperty(c)&&XF.jsStates[c]()&&(a[c]=!0);return a},jsStates:{facebook:function(){return this.fbSdk()},fbSdk:function(){d(k.body).append(d('<div id="fb-root" />'));h.fbAsyncInit=function(){FB.init({version:"v2.7",xfbml:!0})};XF.loadScript("https://connect.facebook.net/"+XF.getLocale()+"/sdk.js");return!0},twitter:function(){h.twttr=function(){var a=h.twttr||{};XF.loadScript("https://platform.twitter.com/widgets.js")&&(a._e=[],a.ready=function(b){a._e.push(b)});
return a}();return!0},flickr:function(){XF.loadScript("https://embedr.flickr.com/assets/client-code.js");return!0},instagram:function(){XF.loadScript("https://platform.instagram.com/"+XF.getLocale()+"/embeds.js",function(){d(k).on("xf:reinit",function(a,b){h.instgrm&&instgrm.Embeds.process(b instanceof d?b.get(0):b)})})},reddit:function(){XF.loadScript("https://embed.redditmedia.com/widgets/platform.js");XF.loadScript("https://www.redditstatic.com/comment-embed.js",function(){d(k).on("xf:reinit",
function(a,b){h.rembeddit&&rembeddit.init()})});return!0},reddit_comment:function(){return this.reddit()},imgur:function(){h.imgurEmbed||(h.imgurEmbed={tasks:d("blockquote.imgur-embed-pub").length});XF.loadScript("//s.imgur.com/min/embed-controller.js",function(){d(k).on("xf:reinit",function(a,b){imgurEmbed.tasks+=d("blockquote.imgur-embed-pub").length;for(a=0;a<imgurEmbed.tasks;a++)imgurEmbed.createIframe(),imgurEmbed.tasks--})});return!0},pinterest:function(){XF.loadScript("//assets.pinterest.com/js/pinit.js",
function(){d(k).on("xf:reinit",function(a,b){PinUtils.build(b instanceof d?b.get(0):b)})});return!0}},getLocale:function(){var a=d("html").attr("lang").replace("-","_");a||(a="en_US");return a},supportsPointerEvents:function(){return"PointerEvent"in h},isEventTouchTriggered:function(a){if(a){if(a.xfPointerType)return"touch"===a.xfPointerType;if(a=a.originalEvent){if(XF.supportsPointerEvents()&&a instanceof PointerEvent)return"touch"===a.pointerType;if(a.sourceCapabilities)return a.sourceCapabilities.firesTouchEvents}}return XF.Feature.has("touchevents")},
getElEffectiveZIndex:function(a){var b=parseInt(a.css("z-index"),10)||0;a.parents().each(function(a,f){a=parseInt(d(f).css("z-index"),10);a>b&&(b=a)});return b},setRelativeZIndex:function(a,b,c,f){f||(f=6);var e=XF.getElEffectiveZIndex(b);f&&f>e&&(e=f);if(null===c||"undefined"===typeof c)c=0;e||c?a.each(function(){var a=d(this);"undefined"==typeof a.data("base-z-index")&&a.data("base-z-index",parseInt(a.css("z-index"),10)||0);a.css("z-index",a.data("base-z-index")+c+e)}):a.css("z-index","")},adjustHtmlForRte:function(a){a=
a.replace(/<img[^>]+>/ig,function(a){if(a.match(/class="([^"]* )?smilie( |")/)){var b;if(b=a.match(/alt="([^"]+)"/))return b[1]}return a});a=a.replace(/([\w\W]|^)<a\s[^>]*data-user-id="\d+"\s+data-username="([^"]+)"[^>]*>([\w\W]+?)<\/a>/gi,function(a,c,d,e){return c+("@"==c?"":"@")+e.replace(/^@/,"")});return a=a.replace(/(<img\s[^>]*)src="[^"]*"(\s[^>]*)data-url="([^"]+)"/gi,function(a,c,d,e){return c+'src="'+e+'"'+d})},requestAnimationTimeout:function(a,b){function c(){Date.now()-e>=b?a():g.id=
d(c)}b||(b=0);var d=h.requestAnimationFrame||function(a){return h.setTimeout(a,1E3/60)},e=Date.now(),g={};g.id=d(c);g.cancel=function(){(h.cancelAnimationFrame||h.clearTimeout)(this.id)};return g},proxy:function(a,b){var c;if("string"===typeof b){var d=a[b];b=a;a=d}if("function"===typeof a)return(c=[].slice.call(arguments,2))?function(){return a.apply(b,c.concat([].slice.call(arguments)))}:a.bind(b,c)},_localLoadTime:null,getLocalLoadTime:function(){if(XF._localLoadTime)return XF._localLoadTime;var a=
XF.config.time,b=d("#_xfClientLoadTime"),c=b.val();if(c&&c.length){var f=c.split(",");if(2==f.length&&parseInt(f[1],10)==a.now){var e=parseInt(f[0],10);b.val(c)}}e||(h.performance&&h.performance.timing&&0!==h.performance.timing.requestStart?(e=h.performance.timing,e=Math.floor((e.requestStart+e.responseStart)/2E3)):e=Math.floor((new Date).getTime()/1E3)-1,b.val(e+","+a.now));return XF._localLoadTime=e},getFutureDate:function(a,b){var c=864E5;switch(b){case "year":c*=365;break;case "month":c*=30}c*=
a;return new Date(Date.now()+c)},smoothScroll:function(a,b,c,f){if("undefined"===typeof c||null===c)c=XF.config.speed.fast;if(a instanceof d||"string"===typeof a){var e=a instanceof d?a:d(a);if(e.length){var g=e.offset().top;a=parseInt(d("html").css("scroll-padding-top"),10);isNaN(a)||(g-=a)}else g=null;!0===b&&(b=e.length?"#"+e.attr("id"):null)}else"number"===typeof a&&(e=null,g=a);if(null===g)console.error("Invalid scroll position");else{0>g&&(g=0);e=function(){b&&"pushState"in h.history&&h.history.pushState({},
"",h.location.toString().replace(/#.*$/,"")+b)};if(f&&(f=d(h).scrollTop(),a=f+d(h).height(),g>=f&&g<=a)){e();return}try{e(),d("html, body").animate({scrollTop:g},c,function(){b&&!h.history.pushState&&(h.location.hash=b)})}catch(l){b&&(h.location.hash=b)}}}}),"function"!=typeof Object.create&&(Object.create=function(){var a=function(){};return function(b){a.prototype=b;b=new a;a.prototype=null;return b}}()),XF.create=function(a){var b=function(){this.__construct.apply(this,arguments)};b.prototype=
Object.create(a);b.prototype.__construct||(b.prototype.__construct=function(){});return b.prototype.constructor=b},XF.extend=function(a,b){var c=function(){this.__construct.apply(this,arguments)},d;c.prototype=Object.create(a.prototype);c.prototype.__construct||(c.prototype.__construct=function(){});c.prototype.constructor=c;if("object"==typeof b){if("object"==typeof b.__backup){a=b.__backup;for(d in a)if(a.hasOwnProperty(d)){if(c.prototype[a[d]])throw Error("Method "+a[d]+" already exists on object. Aliases must be unique.");
c.prototype[a[d]]=c.prototype[d]}delete b.__backup}for(d in b)b.hasOwnProperty(d)&&(c.prototype[d]=b[d])}return c},XF.classToConstructor=function(a){var b=h,c=a.split("."),d;for(d=0;d<c.length;d++)b=b[c[d]];return"function"!=typeof b?(console.error("%s is not a function.",a),!1):b},XF.Cookie={get:function(a){return(a=(new RegExp("(^| )"+XF.config.cookie.prefix+a+"=([^;]+)(;|$)")).exec(k.cookie))?decodeURIComponent(a[2]):null},set:function(a,b,c,d){var e=XF.config.cookie;k.cookie=e.prefix+a+"="+encodeURIComponent(b)+
(void 0===c?"":";expires="+c.toUTCString())+(e.path?";path="+e.path:"")+(e.domain?";domain="+e.domain:"")+(d?";samesite="+d:"")+(e.secure?";secure":"")},getJson:function(a){a=this.get(a);if(!a)return{};try{return d.parseJSON(a)||{}}catch(b){return{}}},setJson:function(a,b,c){this.set(a,JSON.stringify(b),c)},remove:function(a){var b=XF.config.cookie;k.cookie=b.prefix+a+"="+(b.path?"; path="+b.path:"")+(b.domain?"; domain="+b.domain:"")+(b.secure?"; secure":"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"},
supportsExpiryDate:function(){return!0}},XF.LocalStorage={getKeyName:function(a){return XF.config.cookie.prefix+a},get:function(a){var b=null;try{b=h.localStorage.getItem(this.getKeyName(a))}catch(f){}if(null===b){var c=this.getFallbackValue();c&&c.hasOwnProperty(a)&&(b=c[a])}return b},getJson:function(a){a=this.get(a);if(!a)return{};try{return d.parseJSON(a)||{}}catch(b){return{}}},set:function(a,b,c){try{h.localStorage.setItem(this.getKeyName(a),b)}catch(f){c&&(c=this.getFallbackValue(),c[a]=b,
this.updateFallbackValue(c))}},setJson:function(a,b,c){this.set(a,JSON.stringify(b),c)},remove:function(a){try{h.localStorage.removeItem(this.getKeyName(a))}catch(c){}var b=this.getFallbackValue();b&&b.hasOwnProperty(a)&&(delete b[a],this.updateFallbackValue(b))},getFallbackValue:function(){var a=XF.Cookie.get("ls");if(a)try{a=d.parseJSON(a)}catch(b){a={}}return a||{}},updateFallbackValue:function(a){d.isEmptyObject(a)?XF.Cookie.remove("ls"):XF.Cookie.set("ls",JSON.stringify(a))},supportsExpiryDate:function(){return!1}},
XF.CrossTab=function(){function a(a){var c=XF.LocalStorage.getKeyName("__crossTab");if(a.key===c){try{var e=d.parseJSON(a.newValue)}catch(m){return}if(e&&e.event&&(a=e.event,e=e.data||null,c=b[a])){f=a;for(a=0;a<c.length;a++)c[a](e);f=null}}}var b={},c=!1,f;return{on:function(d,g){b[d]||(b[d]=[]);b[d].push(g);c||(c=!0,h.addEventListener("storage",a))},trigger:function(a,b,c){!c&&f&&f==a||XF.LocalStorage.setJson("__crossTab",{event:a,data:b,_:new Date+Math.random()})}}}(),XF.Breakpoint=function(){function a(a){for(var b=
0;b<e.length&&a!=e[b];b++)if(f==e[b])return!0;return!1}function b(a){for(var b=!1,c=0;c<e.length;c++)if(a==e[c])b=!0;else if(f==e[c])return b;return!1}function c(){var a=h.getComputedStyle(d("html")[0],":after").getPropertyValue("content").replace(/"/g,"");if(f){if(a!=f){var b=f;f=a;d(k).trigger("breakpoint:change",[b,a])}}else f=a;return f}var f=null,e=["narrow","medium","wide","full"];c();d(h).onPassive("resize",c);return{current:function(){return f},refresh:c,isNarrowerThan:a,isAtOrNarrowerThan:function(b){return f==
b||a(b)},isWiderThan:b,isAtOrWiderThan:function(a){return f==a||b(a)}}}(),XF.JobRunner=function(){var a=!1,b,c=null,f=0,e,g=null,l=function(){d.ajax({url:XF.canonicalizeUrl("job.php"),type:"post",cache:!1,dataType:"json",global:!1}).always(function(a){a&&a.more&&setTimeout(l,100)})},m=function(a){e=XF.ajax("post",XF.canonicalizeUrl("job.php"),{only_ids:a},function(a){a.more&&a.ids&&a.ids.length?(a.status&&d("#xfAutoBlockingJobStatus").text(a.status),setTimeout(function(){m(a.ids)},0)):(n(),a.moreAuto&&
setTimeout(l,100))},{skipDefault:!0}).fail(n)},n=function(){g&&g.hide();f--;0>f&&(f=0);0==f&&(d(k).trigger("job:auto-blocking-complete"),v());e&&e.abort();e=null},h=function(){c&&c.hide();a=!1;d(k).trigger("job:manual-complete");v();b&&b.abort();b=null},r=function(){c||(c=p("xfManualJobStatus"));return c},p=function(a){a=XF.getOverlayHtml({title:XF.phrase("processing..."),dismissible:!1,html:'<div class="blockMessage"><span id="'+a+'">'+XF.phrase("processing...")+"</span></div>"});return new XF.Overlay(a,
{backdropClose:!1,keyboard:!1})},v=function(){t()||d(k).trigger("job:blocking-complete")},t=function(){return a||0<f};return{isBlockingJobRunning:t,runAuto:l,runAutoBlocking:function(a,b){if("number"===typeof a)a=[a];else if(!Array.isArray(a))return;a.length&&(f++,g||(g=p("xfAutoBlockingJobStatus")),g.show(),b||(b=XF.phrase("processing...")),d("#xfAutoBlockingJobStatus").text(b),m(a))},runManual:function(c){var g=XF.config.job.manualUrl;if(g){if(null===c)e=null;else{var e=e||[];"number"===typeof c?
e.push(c):Array.isArray(c)&&e.push.apply(e,c)}if(!a){a=!0;r().show();var f=function(a){b=XF.ajax("post",g,a?{only_id:a}:null,function(b){b.jobRunner?(d("#xfManualJobStatus").text(b.jobRunner.status||XF.phrase("processing...")),setTimeout(function(){f(a)},0)):l()},{skipDefault:!0}).fail(h)},l=function(){Array.isArray(e)&&0==e.length?h():f(e?e.shift():null)};l()}}},stopManual:h,getManualOverlay:r}}(),XF.Loader=function(){var a=XF.config.css,b=XF.config.js,c=function(c,e,g){c=c||[];e=e||[];var f=[],
m=[],n;for(n=0;n<c.length;n++)b.hasOwnProperty(c[n])||f.push(c[n]);for(n=0;n<e.length;n++)a.hasOwnProperty(e[n])||m.push(e[n]);var h=(f.length?1:0)+(m.length?1:0),k=function(){h--;0==h&&g&&g()};h?(f.length&&XF.loadScripts(f,function(){d.each(f,function(a,c){b[c]=!0});k()}),m.length&&((c=XF.config.url.css)?(c=c.replace("__SENTINEL__",m.join(",")),d.ajax({type:"GET",url:c,cache:!0,global:!1,dataType:"text",success:function(a){var b=XF.config.url.basePath;b&&(a=a.replace(/(url\(("|')?)([^"')]+)(("|')?\))/gi,
function(a,c,d,g,e,f){g.match(/^([a-z]+:|\/)/i)||(g=b+g);return c+g+e}));d("<style>"+a+"</style>").appendTo("head")}}).always(function(){d.each(m,function(b,c){a[c]=!0});k()})):(console.error("No CSS URL so cannot dynamically load CSS"),k()))):g&&g()};return{load:c,loadCss:function(a,b){c([],a,b)},loadJs:function(a,b){c(a,[],b)}}}(),XF.ClassMapper=XF.create({_map:{},_toExtend:{},add:function(a,b){this._map[a]=b},extend:function(a,b){var c=this.getObjectFromIdentifier(a);c?(c=XF.extend(c,b),this._map[a]=
c):(this._toExtend[a]||(this._toExtend[a]=[]),this._toExtend[a].push(b))},getObjectFromIdentifier:function(a){var b=this._map[a],c=this._toExtend[a];if(!b)return null;if("string"==typeof b){b=XF.classToConstructor(b);if(c){for(var d=0;d<c.length;d++)b=XF.extend(b,c[d]);delete this._toExtend[a]}this._map[a]=b}return b}}),XF.ActionIndicator=function(){var a=0,b,c=function(){a++;1==a&&(b||(b=d('<span class="globalAction"><span class="globalAction-bar"></span><span class="globalAction-block"><i></i><i></i><i></i></span></span>').appendTo("body")),
b.addClassTransitioned("is-active"))},f=function(){a--;0<a||(a=0,b&&b.removeClassTransitioned("is-active"))};return{initialize:function(){d(k).on({ajaxStart:c,"xf:action-start":c,ajaxStop:f,"xf:action-stop":f})},show:c,hide:f}}(),XF.DynamicDate=function(){var a,b,c,f,e,g,l=!1,m,h=function(){m=setInterval(function(){x(k)},2E4)},x=function(m){l||this.initialize();m=d(m).find("time[data-time]");var h=m.length,n=Math.floor((new Date).getTime()/1E3)-a,k=new Date;k.setHours(0,0,0,0);b+n>e&&(k.getDay(),
e=r(k,1),c=r(k,0),f=r(k,-1),g=r(k,-6));for(var x=0;x<h;x++){var p=m[x];var q=d(p);var w=parseInt(p.getAttribute("data-time"),10);var y=b-w+n;var u=p.xfDynType;-2>y?(y=w-(b+n),60>y?"futureMoment"!=u&&(q.text(XF.phrase("in_a_moment")),p.xfDynType="futureMoment"):120>y?"futureMinute"!=u&&(q.text(XF.phrase("in_a_minute")),p.xfDynType="futureMinute"):3600>y?(w=Math.floor(y/60),u!=="futureMinutes"+w&&(q.text(XF.phrase("in_x_minutes",{"{minutes}":w})),p.xfDynType="futureMinutes"+w)):w<e?"latertoday"!=u&&
(q.text(XF.phrase("later_today_at_x",{"{time}":q.attr("data-time-string")})),p.xfDynType="latertoday"):w<r(k,2)?"tomorrow"!=u&&(q.text(XF.phrase("tomorrow_at_x",{"{time}":q.attr("data-time-string")})),p.xfDynType="tomorrow"):(604800>y||(q.attr("data-full-date")?q.text(XF.phrase("date_x_at_time_y",{"{date}":q.attr("data-date-string"),"{time}":q.attr("data-time-string")})):q.text(q.attr("data-date-string"))),p.xfDynType="future")):60>=y?"moment"!==u&&(q.text(XF.phrase("a_moment_ago")),p.xfDynType="moment"):
120>=y?"minute"!==u&&(q.text(XF.phrase("one_minute_ago")),p.xfDynType="minute"):3600>y?(w=Math.floor(y/60),u!=="minutes"+w&&(q.text(XF.phrase("x_minutes_ago",{"{minutes}":w})),p.xfDynType="minutes"+w)):w>=c?"today"!==u&&(q.text(XF.phrase("today_at_x",{"{time}":q.attr("data-time-string")})),p.xfDynType="today"):w>=f?"yesterday"!==u&&(q.text(XF.phrase("yesterday_at_x",{"{time}":q.attr("data-time-string")})),p.xfDynType="yesterday"):w>=g?"week"!==u&&(q.text(XF.phrase("day_x_at_time_y",{"{day}":XF.phrase("day"+
(new Date(1E3*w)).getDay()),"{time}":q.attr("data-time-string")})),p.xfDynType="week"):"old"!==u&&(q.attr("data-full-date")?q.text(XF.phrase("date_x_at_time_y",{"{date}":q.attr("data-date-string"),"{time}":q.attr("data-time-string")})):q.text(q.attr("data-date-string")),p.xfDynType="old")}},r=function(a,b){return Math.floor((new Date(a.valueOf())).setFullYear(a.getFullYear(),a.getMonth(),a.getDate()+b)/1E3)};return{initialize:function(){if(!l){l=!0;var n=XF.config.time;a=XF.getLocalLoadTime();b=n.now;
c=n.today;f=n.yesterday;e=n.tomorrow;g=n.week;void 0!==k.hidden?(k.hidden||h(),d(k).on("visibilitychange",function(){k.hidden?clearInterval(m):(h(),x(k))})):h()}},refresh:x}}(),XF.KeepAlive=function(){var a,b,c=!1,f,e=function(){var a=3E3+(Math.floor(241*Math.random())+-120);120>a&&(a=120);f&&clearInterval(f);f=setInterval(m,1E3*a)},g=0,l,m=function(){c&&(!1===h.navigator.onLine&&(g++,5>=g&&(l=setTimeout(m,30))),g=0,clearTimeout(l),d.ajax({url:XF.canonicalizeUrl(a),data:{_xfResponseType:"json",_xfToken:XF.config.csrf},
type:"post",cache:!1,dataType:"json",global:!1}).done(function(a){"ok"==a.status&&(n(a),XF.CrossTab.trigger(b,a))}))},n=function(a){a.csrf&&(XF.config.csrf=a.csrf,d("input[name=_xfToken]").val(a.csrf));if("undefined"!==typeof a.user_id){var b=d(".js-activeUserChangeMessage");a.user_id==XF.config.userId||b.length||XF.addFixedMessage(XF.phrase("active_user_changed_reload_page"),{"class":"js-activeUserChangeMessage"});a.user_id==XF.config.userId&&b.length&&b.remove()}e()};return{initialize:function(){if(!c&&
XF.config.url.keepAlive&&XF.config.url.keepAlive.length){c=!0;a=XF.config.url.keepAlive;b="keepAlive"+XF.stringHashCode(a);e();XF.CrossTab.on(b,n);if(h.performance&&h.performance.navigation){var d=h.performance.navigation.type;0!=d&&1!=d||XF.CrossTab.trigger(b,{csrf:XF.config.csrf,time:XF.config.time.now,user_id:XF.config.userId})}XF.Cookie.get("csrf")||m()}},refresh:m}}(),XF.History=function(){var a=h.history,b=a.state,c=h.location.href,d=[];return{initialize:function(){h.addEventListener("popstate",
function(a){a=a.state;for(var g=!1,e=0;e<d.length;e++)d[e](a,b,c)&&(g=!0);g||c.replace(/#.*$/,"")===h.location.href.replace(/#.*$/,"")||h.location.reload();b=a;c=h.location.href})},handle:function(a){d.push(a)},push:function(d,g,f){a.pushState(d,g,f);b=d;c=h.location.href},replace:function(d,g,f){a.replaceState(d,g,f);b=d;c=h.location.href},go:function(b){a.go(b)}}}(),XF.LinkWatcher=function(){var a=function(a){var b=d(this),c=b.data("proxy-href"),g=b.data("proxy-handler-last");!c||g&&g==a.timeStamp||
(b.data("proxy-handler-last",a.timeStamp),d.ajax({url:XF.canonicalizeUrl(c),data:{_xfResponseType:"json",referrer:h.location.href.replace(/#.*$/,"")},type:"post",cache:!1,dataType:"json",global:!1}))},b=function(a){if(XF.config.enableRtnProtect&&!a.isDefaultPrevented()){var b=d(this),c=b.attr("href"),g=b.data("blank-handler-last");if(c&&(!c.match(/^[a-z]:/i)||c.match(/^https?:/i))&&!b.is("[data-fancybox]")){if(b.is("[rel~=noopener]")){var l=XF.browser;if(l.chrome&&49<=l.version||l.mozilla&&52<=l.version||
l.safari&&11<=l.version)return}if(!(b.closest("[contenteditable=true]").length||(c=XF.canonicalizeUrl(c),(new RegExp("^[a-z]+://"+location.host+"(/|$|:)","i")).test(c)||g&&g==a.timeStamp||(b.data("blank-handler-last",a.timeStamp),l=navigator.userAgent,b=-1!==l.indexOf("MSIE"),g=-1!==l.indexOf("Safari")&&-1==l.indexOf("Chrome"),l=-1!==l.indexOf("Gecko/"),a.shiftKey&&l||g&&(a.shiftKey||a.altKey)||b)))){if(g)b=d('<iframe style="display: none" />').appendTo(k.body),g=b[0].contentDocument||b[0].contentWindow.document,
g.__href=c,c=d("<script />",g),c[0].text="window.opener=null;window.parent=null;window.top=null;window.frameElement=null;window.open(document.__href).opener = null;",g.body.appendChild(c[0]),b.remove();else{c=h.open(c);try{c.opener=null}catch(m){}}a.preventDefault()}}}};return{initLinkProxy:function(){var b="a[data-proxy-href]:not(.link--internal)";d(k).on("click",b,a).on("focusin",b,function(b){b=d(this);b.data("proxy-handler")||b.data("proxy-handler",!0).click(a)})},initExternalWatcher:function(){d(k).on("click",
"a[target=_blank]",b).on("focusin","a[target=_blank]",function(a){a=d(this);a.data("blank-handler")||a.data("blank-handler",!0).click(b)})}}}(),XF._IgnoredWatcher=XF.create({options:{container:"body",ignored:".is-ignored",link:".js-showIgnored"},$container:null,authors:[],shown:!1,__construct:function(a){this.options=d.extend(!0,{},this.options,a||{});this.$container=a=d(this.options.container);this.updateState();a.on("click",this.options.link,XF.proxy(this,"show"))},refresh:function(a){this.$container.find(a).length&&
(this.shown?this.show():this.updateState())},updateState:function(){if(!this.shown){var a=this.getIgnored(),b=[];if(a.length)if(a.each(function(){var a=d(this).data("author");a&&-1===d.inArray(a,b)&&b.push(a)}),b.length){var c={names:b.join(", ")};this.getLinks().each(function(){var a=d(this),b=a.attr("title");b&&a.attr("title",Mustache.render(b,c)).removeClass("is-hidden")})}else this.getLinks().each(function(){d(this).removeAttr("title").removeClass("is-hidden")})}},getIgnored:function(){return this.$container.find(this.options.ignored)},
getLinks:function(){return this.$container.find(this.options.link)},show:function(){this.shown=!0;this.getIgnored().removeClass("is-ignored");this.getLinks().addClass("is-hidden")},initializeHash:function(){if(h.location.hash){var a=h.location.hash.replace(/[^\w_#-]/g,"");if("#"!==a){a=d(a);var b=this.options.ignored;(b=a.is(b)?a:a.closest(b))&&b.length&&(b.removeClass("is-ignored"),a.get(0).scrollIntoView(!0))}}}}),XF.IgnoreWatcher=new XF._IgnoredWatcher,XF.BrowserWarning=function(){return{display:function(){var a=
!1;XF.browser.msie?a=!0:XF.browser.edge&&18>parseInt(XF.browser.version)&&(a=!0);var b=d(".js-browserWarning");a?b.show():b.remove()}}}(),XF.MultiBar=XF.create({options:{role:null,focusShow:!1,className:"",fastReplace:!1},$container:null,$multiBar:null,shown:!1,__construct:function(a,b){this.options=d.extend(!0,{},this.options,b||{});this.$multiBar=a instanceof d?a:d(d.parseHTML(a));this.$multiBar.attr("role",this.options.role||"dialog").attr("aria-hidden","true").on("multibar:hide",XF.proxy(this,
"hide")).on("multibar:show",XF.proxy(this,"show"));this.$container=d('<div class="multiBar-container" />');this.$container.html(this.$multiBar).data("multibar",this).addClass(this.options.className);this.$container.xfUniqueId();this.$container.appendTo("body");XF.activate(this.$container);XF.MultiBar.cache[this.$container.attr("id")]=this},show:function(){if(!this.shown){this.shown=!0;this.$multiBar.attr("aria-hidden","false");d(".p-pageWrapper").addClass("has-multiBar");this.options.fastReplace&&
this.$multiBar.css("transition-duration","0s");var a=this;this.$container.appendTo("body");this.$multiBar.addClassTransitioned("is-active",function(){if(a.options.focusShow){var b=a.$multiBar.find(".js-multiBarClose");XF.autoFocusWithin(a.$multiBar.find(".multiBar-content"),null,b)}a.$container.trigger("multibar:shown");XF.layoutChange()});this.options.fastReplace&&this.$multiBar.css("transition-duration","");this.$container.trigger("multibar:showing");XF.layoutChange()}},hide:function(){if(this.shown){this.shown=
!1;this.$multiBar.attr("aria-hidden","true");var a=this;this.$multiBar.removeClassTransitioned("is-active",function(){d(".p-pageWrapper").removeClass("has-multiBar");a.$container.trigger("multibar:hidden");XF.layoutChange()});this.$container.trigger("multibar:hiding");XF.layoutChange()}},toggle:function(a){(null===a?!this.shown:a)?this.show():this.hide()},destroy:function(){var a=this.$container.attr("id"),b=XF.MultiBar.cache;this.$container.remove();b.hasOwnProperty(a)&&delete b[a]},on:function(){this.$container.on.apply(this.$container,
arguments)},getContainer:function(){return this.$container},getMultiBar:function(){return this.$multiBar}}),XF.MultiBar.cache={},XF.showMultiBar=function(a,b){a=new XF.MultiBar(a,b);a.show();return a},XF.loadMultiBar=function(a,b,c,f){d.isFunction(c)&&(c={init:c});c=d.extend({cache:!1,beforeShow:null,afterShow:null,onRedirect:null,init:null,show:!0},c||{});var e=function(a){if(c.beforeShow){var b=d.Event();c.beforeShow(a,b);if(b.isDefaultPrevented())return}c.show&&a.show();c.afterShow&&(b=d.Event(),
c.afterShow(a,b),b.isDefaultPrevented())};if(c.cache&&XF.loadMultiBar.cache[a])e(XF.loadMultiBar.cache[a]);else{var g=function(b){if(b.redirect)if(c.onRedirect)c.onRedirect(b,g);else XF.ajax("get",b.redirect,function(a){g(a)});b.html&&XF.setupHtmlInsert(b.html,function(b,d,g){var l=new XF.MultiBar(XF.getMultiBarHtml({html:b,title:d.title||d.h1}),f);c.init&&c.init(l);if(!c.cache)l.on("multibar:hidden",function(){l.destroy()});g();c.cache&&(XF.loadMultiBar.cache[a]=l);e(l)})};return XF.ajax("post",
a,b,function(a){g(a)})}},XF.loadMultiBar.cache={},XF.Overlay=XF.create({options:{backdropClose:!0,escapeClose:!0,focusShow:!0,className:""},$container:null,$overlay:null,shown:!1,__construct:function(a,b){this.options=d.extend(!0,{},this.options,b||{});this.$overlay=a instanceof d?a:d(d.parseHTML(a));this.$overlay.attr("role",this.options.role||"dialog").attr("aria-hidden","true");this.$container=d('<div class="overlay-container" />').html(this.$overlay);this.$container.data("overlay",this).xfUniqueId();
var c=this;if(this.options.escapeClose)this.$container.on("keydown.overlay",function(a){27===a.which&&c.hide()});this.options.backdropClose&&(this.$container.on("mousedown",function(a){c.$container.data("block-close",!1);d(a.target).is(c.$container)||c.$container.data("block-close",!0)}),this.$container.on("click",function(a){d(a.target).is(c.$container)&&(c.$container.data("block-close")||c.hide());c.$container.data("block-close",!1)}));this.options.className&&this.$container.addClass(this.options.className);
this.$container.on("click",".js-overlayClose",XF.proxy(this,"hide"));this.$container.appendTo("body");XF.activate(this.$container);XF.Overlay.cache[this.$container.attr("id")]=this;this.$overlay.on("overlay:hide",XF.proxy(this,"hide"));this.$overlay.on("overlay:show",XF.proxy(this,"show"))},show:function(){if(!this.shown){this.shown=!0;this.$overlay.attr("aria-hidden","false");var a=this;this.$container.appendTo("body").addClassTransitioned("is-active",function(){if(a.options.focusShow){var b=a.$overlay.find(".js-overlayClose");
XF.autoFocusWithin(a.$overlay.find(".overlay-content"),null,b)}a.$container.trigger("overlay:shown");XF.layoutChange()});this.$container.trigger("overlay:showing");XF.ModalOverlay.open();XF.layoutChange()}},hide:function(){if(this.shown){this.shown=!1;this.$overlay.attr("aria-hidden","true");var a=this;this.$container.removeClassTransitioned("is-active",function(){a.$container.trigger("overlay:hidden");XF.ModalOverlay.close();XF.layoutChange()});this.$container.trigger("overlay:hiding");XF.layoutChange()}},
recalculate:function(){this.shown&&XF.Modal.updateScrollbarPadding()},toggle:function(){this.shown?this.hide():this.show()},destroy:function(){var a=this.$container.attr("id"),b=XF.Overlay.cache;this.$container.remove();b.hasOwnProperty(a)&&delete b[a]},on:function(){this.$container.on.apply(this.$container,arguments)},getContainer:function(){return this.$container},getOverlay:function(){return this.$overlay}}),XF.Overlay.cache={},XF.ModalOverlay=function(){var a=0,b=d("body").first();return{getOpenCount:function(){return a},
open:function(){XF.Modal.open();a++;1==a&&b.addClass("is-modalOverlayOpen")},close:function(){XF.Modal.close();0<a&&(a--,0==a&&b.removeClass("is-modalOverlayOpen"))}}}(),XF.Modal=function(){var a=0,b=d("body").first(),c=d("html"),f=function(){var a="right",d=b.hasClass("is-modalOpen")?XF.measureScrollBar()+"px":"";XF.isRtl()&&(XF.browser.chrome||XF.browser.mozilla||(a="left"));c.css("margin-"+a,d)};return{getOpenCount:function(){return a},open:function(){a++;1==a&&(b.addClass("is-modalOpen"),f())},
close:function(){0<a&&(a--,0==a&&(b.removeClass("is-modalOpen"),f()))},updateScrollbarPadding:f}}(),XF.showOverlay=function(a,b){a=new XF.Overlay(a,b);a.show();return a},XF.loadOverlay=function(a,b,c){d.isFunction(b)&&(b={init:b});b=d.extend({cache:!1,beforeShow:null,afterShow:null,onRedirect:null,init:null,show:!0},b||{});var f=function(a){if(b.beforeShow){var c=d.Event();b.beforeShow(a,c);if(c.isDefaultPrevented())return}b.show&&a.show();b.afterShow&&(c=d.Event(),b.afterShow(a,c),c.isDefaultPrevented())};
if(b.cache&&XF.loadOverlay.cache[a])f(XF.loadOverlay.cache[a]);else{var e=function(d){if(d.redirect)if(b.onRedirect)b.onRedirect(d,e);else XF.ajax("get",d.redirect,function(a){e(a)});d.html&&XF.setupHtmlInsert(d.html,function(d,g,e){var l=new XF.Overlay(XF.getOverlayHtml({html:d,title:g.title||g.h1}),c);b.init&&b.init(l);if(!b.cache)l.on("overlay:hidden",function(){l.destroy()});e();b.cache&&(XF.loadOverlay.cache[a]=l);f(l)})};return XF.ajax("get",a,function(a){e(a)})}},XF.loadOverlay.cache={},XF.NavDeviceWatcher=
function(){function a(a){a!=b&&(d("html").toggleClass("has-pointer-nav",!a),b=a)}var b=!0;return{initialize:function(){d(k).onPassive({mousedown:function(){a(!1)},keydown:function(b){switch(b.key){case "Tab":case "Enter":a(!0)}}})},toggle:a,isKeyboardNav:function(){return b}}}(),XF.ScrollButtons=function(){function a(a){if(!x){a=h.pageYOffset||k.documentElement.scrollTop;var c=v;v=a;if(a>c)"down"!=t&&(t="down",A=c);else if(a<c)"up"!=t&&(t="up",A=c);else return;if(r){if("up"!==t||100>v){B&&(B.cancel(),
B=null);return}if(30>A-a)return}B||(B=XF.requestAnimationTimeout(function(){B=null;b();f()},200))}}function b(){p||(z.addClassTransitioned("is-active"),p=!0)}function c(){p&&(z.removeClassTransitioned("is-active"),p=!1)}function f(){e();n=setTimeout(function(){c()},3E3)}function e(){clearTimeout(n)}function g(){e();b()}function l(){e()}function m(){x=!0;setTimeout(function(){x=!1},500);c()}var n=null,x=!1,r=!1,p=!1,v=h.pageYOffset||k.documentElement.scrollTop,t=null,A=null,B,z=null;return{initialize:function(){if(z&&
z.length)return!1;z=d(".js-scrollButtons");if(!z.length)return!1;"up"===z.data("trigger-type")&&(r=!0);z.on({"mouseenter focus":g,"mouseleave blur":l,click:m});d(h).onPassive("scroll",a);return!0},show:b,hide:c,startHideTimer:f,clearHideTimer:e}}(),XF.KeyboardShortcuts=function(){function a(c){c=d(c);1<c.length?c.each(function(){a(this)}):(c.is("[data-xf-key]")&&b(c[0]),c.find("[data-xf-key]").each(function(){b(this)}))}function b(a){var b=String(d(a).data("xf-key")),c=b.substr(b.lastIndexOf("+")+
1),g="#"===c[0]?c.substr(1):c.toUpperCase().charCodeAt(0),f=b.toUpperCase().split("+");var h=-1!==f.indexOf("CTRL");var k=-1!==f.indexOf("ALT");f=-1!==f.indexOf("META");(h=0+h?1:0+k?2:0+f?4:0)?XF.Keyboard.isStandardKey(g)?(e[g]=e[g]||{},e[g][h]=a):console.warn("It is not possible to specify a keyboard shortcut using this key combination (%s)",b):e[c]=a}function c(a){switch(a.key){case "Escape":XF.MenuWatcher.closeAll();XF.hideTooltips();return;case "Shift":case "Control":case "Alt":case "Meta":return}if(XF.Keyboard.isShortcutAllowed(k.activeElement)&&
(!e.hasOwnProperty(a.key)||0!=(0+a.ctrlKey?1:0+a.altKey?2:0+a.metaKey?4:0)||!f(e[a.key]))&&e.hasOwnProperty(a.which)){var b=0+a.ctrlKey?1:0+a.altKey?2:0+a.metaKey?4:0;e[a.which].hasOwnProperty(b)&&f(e[a.which][b])}}function f(a){a=d(a).filter(":visible");return a.length?(XF.NavDeviceWatcher.toggle(!0),XF.isElementVisible(a)||a.get(0).scrollIntoView(!0),a.is(XF.getKeyboardInputs())?a.autofocus():a.is("a[href]")?a.get(0).click():a.click(),!0):!1}var e={};return{initialize:function(){d(k.body).onPassive("keyup",
c)},initializeElements:a}}(),XF.Keyboard={isShortcutAllowed:function(a){switch(a.tagName){case "TEXTAREA":case "SELECT":return!1;case "INPUT":switch(a.type){case "checkbox":case "radio":case "submit":case "reset":return!0;default:return!1}case "BODY":return!0;default:return XF.browser.msie&&d(a).parents(".fr-element").length?!1:"true"===a.contentEditable?!1:!0}},isStandardKey:function(a){return 48<=a&&90>=a}},XF.FormInputValidation=function(){function a(b){b=d(b);1<b.length?b.each(function(){a(this)}):
b.is("form")&&c(b)}function b(){e.length&&e.each(function(){c(d(this))})}function c(a){a.find(":input").on("invalid",{form:a},f)}function f(a){var b=d(this);a=a.data.form;var c=a.find(":invalid").first();b[0]!==c[0]||XF.isElementVisible(b)||(a=a.closest(".overlay-container.is-active"),a.length?a.scrollTop(b.offset().top-a.offset().top+a.scrollTop()-100):(b[0].scrollIntoView(),h.scrollBy(0,-100)))}var e={};return{initialize:function(){e=d("form").not("[novalidate]");b()},initializeElements:a}}(),XF.NoticeWatcher=
function(){return{initialize:function(){d(k).on("xf:notice-change xf:layout",XF.proxy(this,"checkNotices"));this.checkNotices()},checkNotices:function(){var a=this.getBottomFixerNoticeHeight();d(k).find("footer.p-footer").css("margin-bottom",a)},getBottomFixerNoticeHeight:function(){var a=0;d(k).find(".js-bottomFixTarget .notices--bottom_fixer .js-notice").each(function(){var b=d(this);b.is(":visible")&&(a+=b.height())});return a}}}(),XF.PWA=function(){function a(){return navigator.standalone||h.matchMedia("(display-mode: standalone), (display-mode: minimal-ui)").matches}
function b(){g&&(XF.ActionIndicator.show(),setTimeout(function(){XF.ActionIndicator.hide()},3E4))}function c(){g=!1;setTimeout(function(){g=!0},2E3)}function f(a,b){if(navigator.serviceWorker.controller)if("string"!==typeof a||""===a)console.error("Invalid message type:",a);else{if("undefined"===typeof b)b={};else if("object"!==typeof b||null===b){console.error("Invalid message payload:",b);return}navigator.serviceWorker.controller.postMessage({type:a,payload:b})}else console.error("There is no active service worker")}
var e,g=!0,l={};return{initialize:function(){XF.PWA.isSupported()&&(XF.config.skipServiceWorkerRegistration?e=new Promise(function(a,b){b(Error("Service worker registration has been skipped"))}):(e=navigator.serviceWorker.register(XF.canonicalizeUrl("service_worker.js")),e.then(function(a){var b=XF.config.cacheKey;a=a.active?!1:!0;XF.LocalStorage.get("cacheKey")!==b&&(a||f("updateCache"),XF.LocalStorage.set("cacheKey",b,!0))}),e.catch(function(a){console.error("Service worker registration failed:",
a)}),navigator.serviceWorker.getRegistrations().then(function(a){var b=XF.canonicalizeUrl("js/xf/"),c;for(c in a)a[c].scope==b&&a[c].unregister()}),navigator.serviceWorker.addEventListener("message",function(a){var b=a.data;if("object"!==typeof b||null===b)console.error("Invalid message:",b);else if(a=b.type,b=b.payload,"string"!==typeof a||""===a)console.error("Invalid message type:",a);else if("object"!==typeof b||null===b)console.error("Invalid message payload:",b);else{var c=l[a];"undefined"===
typeof c?console.error("No handler available for message type:",a):c(b)}}),a()&&(d(h).on("beforeunload",b),d(k).on("click",".js-skipPwaNavIndicator",c))))},isSupported:function(){return"serviceWorker"in navigator},isRunning:a,inhibitNavigationIndicator:c,getRegistration:function(){return e},sendMessage:f}}(),XF.Push=function(){function a(a,c){XF.PWA.getRegistration().then(function(){b();a&&a()}).catch(function(){c&&c()})}function b(){XF.PWA.getRegistration().then(function(a){return a.pushManager.getSubscription()}).then(function(a){XF.Push.isSubscribed=
null!==a;XF.Push.isSubscribed?(d(k).trigger("push:init-subscribed"),XF.config.userId&&f(a)?XF.Push.updateUserSubscription(a,"update"):(a.unsubscribe(),XF.Push.updateUserSubscription(a,"unsubscribe"))):d(k).trigger("push:init-unsubscribed")})}function c(a){var b="=".repeat((4-a.length%4)%4);a=(a+b).replace(/\-/g,"+").replace(/_/g,"/");a=h.atob(a);b=new Uint8Array(a.length);for(var c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}function f(a){a instanceof PushSubscription&&(a=a.options.applicationServerKey);
if("string"===typeof a)return XF.config.pushAppServerKey===a;a.buffer&&a.BYTES_PER_ELEMENT&&(a=a.buffer);if(!(a instanceof ArrayBuffer))throw Error("input must be an array buffer or convertable to it");var b=c(XF.config.pushAppServerKey).buffer,d=b.byteLength;if(d!==a.byteLength)return!1;b=new DataView(b);a=new DataView(a);for(var e=0;e<d;e++)if(b.getUint8(e)!==a.getUint8(e))return!1;return!0}var e=null;return{isSubscribed:null,initialize:function(){XF.Push.isSupported()&&(XF.config.skipPushNotificationSubscription||
a())},registerWorker:a,getPushHistoryUserIds:function(){return XF.LocalStorage.getJson("push_history_user_ids")||{}},setPushHistoryUserIds:function(a){XF.LocalStorage.setJson("push_history_user_ids",a||{})},hasUserPreviouslySubscribed:function(a){return XF.Push.getPushHistoryUserIds().hasOwnProperty(a||XF.config.userId)},addUserToPushHistory:function(a){var b=XF.Push.getPushHistoryUserIds();b[a||XF.config.userId]=!0;XF.Push.setPushHistoryUserIds(b)},removeUserFromPushHistory:function(a){var b=XF.Push.getPushHistoryUserIds();
delete b[a||XF.config.userId];XF.Push.setPushHistoryUserIds(b)},handleUnsubscribeAction:function(a,b){XF.Push.isSubscribed&&XF.PWA.getRegistration().then(function(a){return a.pushManager.getSubscription()}).then(function(a){if(a)return e=a,a.unsubscribe()}).catch(function(a){console.error("Error unsubscribing",a);b&&b()}).then(function(){e&&XF.Push.updateUserSubscription(e,"unsubscribe");XF.Push.isSubscribed=!1;a&&a()})},handleSubscribeAction:function(a,b,c){XF.Push.isSubscribed||Notification.requestPermission().then(function(d){if("granted"!==
d)console.error("Permission was not granted");else{var e=XF.Push.base64ToUint8(XF.config.pushAppServerKey);XF.PWA.getRegistration().then(function(d){d.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e}).then(function(c){XF.Push.updateUserSubscription(c,"insert");XF.Push.isSubscribed=!0;c={body:XF.phrase("push_enable_notification_body"),dir:XF.isRtl()?"rtl":"ltr"};XF.config.publicMetadataLogoUrl&&(c.icon=XF.config.publicMetadataLogoUrl);XF.config.publicPushBadgeUrl&&(c.badge=XF.config.publicPushBadgeUrl);
a||d.showNotification(XF.phrase("push_enable_notification_title"),c);XF.config.userId&&XF.Push.addUserToPushHistory();b&&b()}).catch(function(a){console.error("Failed to subscribe the user: ",a);c&&c()})})}})},handleToggleAction:function(a,b,c,d){XF.Push.isSubscribed?XF.Push.handleUnsubscribeAction(a,b):XF.Push.handleSubscribeAction(!1,c,d)},updateUserSubscription:function(a,b){if("update"!==b||!XF.Cookie.get("push_subscription_updated")){var c=a.getKey("p256dh"),e=a.getKey("auth"),g=(PushManager.supportedContentEncodings||
["aesgcm"])[0];d.ajax({url:XF.canonicalizeUrl("index.php?misc/update-push-subscription"),type:"post",data:{endpoint:a.endpoint,key:c?btoa(String.fromCharCode.apply(null,new Uint8Array(c))):null,token:e?btoa(String.fromCharCode.apply(null,new Uint8Array(e))):null,encoding:g,unsubscribed:"unsubscribe"===b?1:0,_xfResponseType:"json",_xfToken:XF.config.csrf},cache:!1,dataType:"json",global:!1}).always(function(){"update"===b&&XF.Cookie.set("push_subscription_updated","1")})}},isSupported:function(){return XF.PWA.isSupported()&&
XF.config.enablePush&&XF.config.pushAppServerKey&&"PushManager"in h&&"Notification"in h},base64ToUint8:c,isExpectedServerKey:f}}(),XF.ExpandableContent=function(){function a(a){d(a).find(".js-expandWatch:not(.is-expanded)").each(function(){var a=d(this),b=a.find(".js-expandContent")[0];if(b){var e,g=0,l=function(){var c=b.scrollHeight,d=b.offsetHeight;0==c||0==d?2E3<g||(e&&(clearTimeout(e),g+=200),e=setTimeout(l,g)):c>d+1?a.addClass("is-expandable"):a.removeClass("is-expandable")};l();if(!a.data("expand-check-triggered")&&
(a.data("expand-check-triggered",!0),a.find("img").one("load",l),h.MutationObserver)){var k,n=!0,x=function(){n=!1;l();setTimeout(function(){n=!0},100)};var r=new MutationObserver(function(b){a.hasClass("is-expanded")?r.disconnect():n&&(k&&clearTimeout(k),k=setTimeout(x,200))});r.observe(this,{attributes:!0,childList:!0,subtree:!0})}}})}return{watch:function(){d(k).on("click",".js-expandLink",function(a){d(a.target).closest(".js-expandWatch").addClassTransitioned("is-expanded",XF.layoutChange)});
d(h).onPassive("resize",function(){a(k)});d(k).on("embed:loaded",function(){a(k)})},checkSizing:a}}(),XF.UnfurlLoader=function(){function a(){function d(a){var b=null===g?a:a.substring(g);var c=b.indexOf("\n");-1!==c&&(b=b.substring(0,c),g=null===g?b.length:g+b.length,g++,XF.UnfurlLoader.handleResponse(JSON.parse(b)),g<a.length&&d(a))}if(b.length&&!c){var g=null;c=!0;XF.ajax("post",XF.canonicalizeUrl("unfurl.php"),{result_ids:b},function(a){d(a)},{skipDefault:!0,dataType:"text",xhrFields:{onprogress:function(a){a=
a.currentTarget.response;a.length&&d(a)}}}).always(function(){b=[];c=!1;g=null;f&&(b=f,f=[],c=!1,setTimeout(a,0))})}}var b=[],c=!1,f=[];return{activateContainer:function(e){e=d(e).find(".js-unfurl");e.length&&(e.each(function(){var a=d(this);if(!1===a.data("pending")||a.data("pending-seen"))return!0;a.data("pending-seen",!0);a=a.data("result-id");c?f.push(a):b.push(a)}),a())},unfurl:a,handleResponse:function(a){var b=d('.js-unfurl[data-result-id="'+a.result_id+'"]');b.length&&(a.success?XF.setupHtmlInsert(a.html,
function(a,c,d){b.replaceWith(a)}):(a=b.find(".js-unfurl-title a"),a.text(b.data("url")).addClass("bbCodePlainUnfurl").removeClass("fauxBlockLink-blockLink"),b.replaceWith(a)))}}}(),XF.Event=function(){var a=new XF.ClassMapper,b={},c=function(b,c,f){b=d(b);var e=b.data("xf-"+c).split(" ")||[],g=b.data("xf-"+c+"-handlers")||{},l;for(l=0;l<e.length;l++){var h=e[l];if(h.length){if(!g[h]){var k=a.getObjectFromIdentifier(h);if(!k){console.error("Could not find %s handler for %s",c,h);continue}var v=b.data("xf-"+
h)||{};g[h]=new k(b,v)}if(f&&!1===g[h]._onEvent(f))break}}b.data("xf-"+c+"-handlers",g);return g},f=XF.create({initialized:!1,eventType:"click",eventNameSpace:null,$target:null,options:{},__construct:function(a,b){this.$target=a;this.options=XF.applyDataOptions(this.options,a.data(),b);this.eventType=this.eventType.toLowerCase();if(!this.eventNameSpace)throw Error("Please provide an eventNameSpace for your extended "+this.eventType+" handler class");this._init()},_init:function(){var a=new d.Event("xf-"+
this.eventType+":before-init."+this.eventNameSpace),b=!1;this.$target.trigger(a,[this]);a.isDefaultPrevented()||(b=this.init(),this.$target.trigger("xf-"+this.eventType+":after-init."+this.eventNameSpace,[this,b]));this.initialized=!0;return b},_onEvent:function(a){var b=new d.Event("xf-"+this.eventType+":before-"+this.eventType+"."+this.eventNameSpace);this.$target.trigger(b,[this]);if(!b.isDefaultPrevented()){if("function"==typeof this[this.eventType])b=this[this.eventType](a);else if("function"==
typeof this.onEvent)b=this.onEvent(a);else return console.error("You must provide a %1$s(e) method for your %1$s event handler",this.eventType,this.eventNameSpace),a.preventDefault(),!1;this.$target.trigger("xf-"+this.eventType+":after-"+this.eventType+"."+this.eventNameSpace,[this,b,a])}return null},init:function(){console.error("This is the abstract init method for XF.%s, which must be overridden.",this.eventType,this.eventNameSpace)}});return{watch:function(a){function e(a,b){b||(b=a.currentTarget);
if(!b||!b.getAttribute)return!1;b=d(b);return b.is("a")&&!b.data("click-allow-modifier")&&(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey||1<a.which)||b.closest("[contenteditable=true]").length?!1:!0}a=String(a).toLowerCase();b.hasOwnProperty(a)||(b[a]=!0,d(k).on(a,"[data-xf-"+a+"]",function(b){var f=b.currentTarget;if(e(b,f)){var g=d(f).data("xf-pointer-type");b.xfPointerType=b.pointerType||g||"";c(f,a,b)}}),d(k).on("pointerdown","[data-xf-"+a+"]",function(a){var b=a.currentTarget;e(a,b)&&d(b).data("xf-pointer-type",
a.pointerType)}))},initElement:c,getElementHandler:function(a,b,c){var d=a.data("xf-"+c+"-handlers");d||(d=XF.Event.initElement(a[0],c));return d&&d[b]?d[b]:null},register:function(b,c,d){XF.Event.watch(b);a.add(c,d)},extend:function(b,c){a.extend(b,c)},newHandler:function(a){return XF.extend(f,a)},AbstractHandler:f}}(),XF.Click=function(){return{watch:function(){return XF.Event.watch("click")},initElement:function(a,b){return XF.Event.initElement(a,"click",b)},getElementHandler:function(a,b){return XF.Event.getElementHandler(a,
b,"click")},register:function(a,b){XF.Event.watch("click");return XF.Event.register("click",a,b)},extend:function(a,b){return XF.Event.extend(a,b)},newHandler:function(a){return XF.Event.newHandler(a)}}}(),XF.Element=function(){var a=new XF.ClassMapper,b=function(b,c,d){var e=b.data("xf-element-handlers")||{};if(e[c])return e[c];var f=a.getObjectFromIdentifier(c);if(!f)return null;d=new f(b,d||{});e[c]=d;b.data("xf-element-handlers",e);d.init();return d},c=function(a){a instanceof d&&(a=a[0]);if(a&&
a.getAttribute){var c=a.getAttribute("data-xf-init");if(c){c=c.split(" ");var e=c.length;a=d(a);for(var f,g=0;g<e;g++)(f=c[g])&&b(a,f,a.data("xf-"+f))}}},f=function(a){a=d(a);1<a.length?a.each(function(){f(this)}):(a.is("[data-xf-init]")&&c(a[0]),a.find("[data-xf-init]").each(function(){c(this)}))},e=XF.create({$target:null,options:{},__construct:function(a,b){this.$target=a;this.options=XF.applyDataOptions(this.options,a.data(),b)},init:function(){console.error("This is the abstract init method for XF.Element, which should be overridden.")},
getOption:function(a){return this.options[a]}});return{register:function(b,c){a.add(b,c)},extend:function(b,c){a.extend(b,c)},initialize:f,initializeElement:c,applyHandler:b,getHandler:function(a,b){var d=a.data("xf-element-handlers");void 0===d&&(c(a),d=a.data("xf-element-handlers"));return d&&d[b]?d[b]:null},newHandler:function(a){return XF.extend(e,a)},AbstractHandler:e}}(),XF.AutoCompleteResults=XF.create({selectedResult:0,$results:!1,$scrollWatchers:null,resultsVisible:!1,resizeBound:!1,headerHtml:null,
options:{},__construct:function(a){this.options=d.extend({onInsert:null,clickAttacher:null,beforeInsert:null,insertMode:"text",displayTemplate:"{{{icon}}}{{{text}}}",wrapperClasses:""},a)},isVisible:function(){return this.resultsVisible},hideResults:function(){this.resultsVisible=!1;this.$results&&this.$results.hide();this.stopScrollWatching()},stopScrollWatching:function(){this.$scrollWatchers&&(this.$scrollWatchers.off("scroll.autocomplete"),this.$scrollWatchers=null)},addHeader:function(a){this.headerHtml=
a},showResults:function(a,b,c,f){var e;if(b){this.resultsVisible=!1;this.$results?this.$results.hide().empty():(this.$results=d("<ul />").css({position:"absolute",display:"none"}).addClass("autoCompleteList "+this.options.wrapperClasses).attr("role","listbox").appendTo(k.body),XF.setRelativeZIndex(this.$results,c,1));a=new RegExp("("+XF.regexQuote(XF.htmlspecialchars(a))+")","i");for(e in b)if(b.hasOwnProperty(e)){var g=b[e];var l=d("<li />").css("cursor","pointer").attr("unselectable","on").attr("role",
"option").mouseenter(XF.proxy(this,"resultMouseEnter"));this.options.clickAttacher?this.options.clickAttacher(l,XF.proxy(this,"resultClick")):l.click(XF.proxy(this,"resultClick"));var m={icon:"",text:"",desc:""};if("string"==typeof g){var n=g;m.text=XF.htmlspecialchars(g)}else if(n=g.text,m.text=XF.htmlspecialchars(g.text),"undefined"!==typeof g.desc&&(m.desc=XF.htmlspecialchars(g.desc)),"undefined"!==typeof g.icon?m.icon=d('<img class="autoCompleteList-icon" />').attr("src",XF.htmlspecialchars(g.icon)):
"undefined"!==typeof g.iconHtml&&(m.icon=d('<span class="autoCompleteList-icon" />').html(g.iconHtml)),m.icon&&(m.icon=m.icon[0].outerHTML),g.extraParams){var x=g.extraParams,r;for(r in x)if(x.hasOwnProperty(r)){var p=r.match(/Html$/),v=p?r.replace(/Html$/,""):r;p=p?x[r]:XF.htmlspecialchars(x[r]);m[v]=p}}l.data("insert-text",n);l.data("insert-html",g.html||"");m.text=m.text.replace(a,"<strong>$1</strong>");m.desc=m.desc.replace(a,"<strong>$1</strong>");l.html(Mustache.render(this.options.displayTemplate,
m)).appendTo(this.$results)}if(this.$results.children().length){this.selectResult(0,!0);this.headerHtml&&(l=d("<li />").addClass("menu-header menu-header--small").attr("unselectable","on").html(this.headerHtml),l.prependTo(this.$results));if(!this.resizeBound)d(h).onPassive("resize",XF.proxy(this,"hideResults"));this.$results.css({top:"",left:"",right:"",bottom:""});var t=this.$results,A=function(a){d.isFunction(a)&&(a=a(t,c));if(!a){var b=c.offset();a={top:b.top+c.outerHeight(),left:b.left};XF.isRtl()&&
(a.right=d("html").width()-b.left-c.outerWidth(),a.left="auto")}return a};this.stopScrollWatching();(b=c.parents().filter(function(){switch(d(this).css("overflow-x")){case "scroll":case "auto":return!0;default:return!1}}))&&b.length&&(b.on("scroll.autocomplete",function(){t.css(A(f))}),this.$scrollWatchers=b);this.$results.css(A(f)).show();this.resultsVisible=!0}}else this.hideResults()},resultClick:function(a){a.stopPropagation();this.insertResult(this.getResultText(a.currentTarget),a.currentTarget,
a);this.hideResults()},resultMouseEnter:function(a){this.selectResult(d(a.currentTarget).index(),!0)},selectResult:function(a,b){if(this.$results){var c=this.selectedResult=b?a:this.selectedResult+a;a=this.$results.children();a.each(function(a){a==c?d(this).addClass("is-selected"):d(this).removeClass("is-selected")});if(0>c||c>=a.length)this.selectedResult=-1}},insertSelectedResult:function(a){var b,c=!1;if(!this.resultsVisible)return!1;0<=this.selectedResult&&(b=this.$results.children().get(this.selectedResult))&&
(c=this.getResultText(b),this.options.beforeInsert&&(c=this.options.beforeInsert(c,b)),this.insertResult(c,b,a),c=!0);this.hideResults();return c},insertResult:function(a,b,c){if(this.options.onInsert)this.options.onInsert(a,b,c)},getResultText:function(a){switch(this.options.insertMode){case "text":var b=d(a).data("insert-text");break;case "html":b=d(a).data("insert-html")}return b}}),XF.AutoCompleter=XF.create({options:{url:null,method:"GET",idleWait:200,minLength:2,at:"@",keepAt:!0,insertMode:"text",
displayTemplate:"{{{icon}}}{{{text}}}",beforeInsert:null},$input:null,ed:null,results:null,visible:!1,idleTimer:null,pendingQuery:"",__construct:function(a,b,c){this.options=d.extend(!0,{},this.options,b);this.$input=a;this.ed=c;this.options.url?(("string"!=typeof this.options.at||1<this.options.at.length)&&console.error("The 'at' option should be a single character string."),this.init()):console.error("No URL option passed in to XF.AutoCompleter.")},init:function(){var a=this,b={onInsert:function(b){a.insertResult(b)},
beforeInsert:this.options.beforeInsert,insertMode:this.options.insertMode,displayTemplate:this.options.displayTemplate};this.ed&&(b.clickAttacher=function(b,d){a.ed.events.bindClick(b,b,d)});this.results=new XF.AutoCompleteResults(b);this.ed?(this.ed.events.on("keydown",XF.proxy(this,"keydown"),!0),this.ed.events.on("keyup",XF.proxy(this,"keyup"),!0),this.ed.events.on("click blur",XF.proxy(this,"blur")),d(this.ed.$wp).onPassive("scroll",XF.proxy(this,"blur"))):(this.$input.on("keydown",XF.proxy(this,
"keydown")),this.$input.on("keyup",XF.proxy(this,"keyup")),this.$input.on("click blur",XF.proxy(this,"blur")),d(k).onPassive("scroll",XF.proxy(this,"blur")))},keydown:function(a){if(this.visible)switch(a.which){case 40:return this.results.selectResult(1),a.preventDefault(),!1;case 38:return this.results.selectResult(-1),a.preventDefault(),!1;case 27:return this.hide(),a.preventDefault(),!1;case 13:if(this.visible)return this.results.insertSelectedResult(a),a.preventDefault(),!1}},keyup:function(a){if(this.visible)switch(a.which){case 40:case 38:case 13:return}this.hide();
this.idleTimer&&clearTimeout(this.idleTimer);this.idleTimer=setTimeout(XF.proxy(this,"lookForMatch"),this.options.idleWait)},blur:function(){this.visible&&setTimeout(XF.proxy(this,"hide"),250)},lookForMatch:function(){var a=this.getCurrentMatchInfo();a?this.foundMatch(a.query):this.hide()},getCurrentMatchInfo:function(){if(this.ed){var a=this.ed.selection.ranges(0);if(!a||!a.collapsed)return null;var b=a.endContainer;if(!b||3!==b.nodeType)return null;var c=b;b=b.nodeValue.substring(0,a.endOffset)}else{b=
this.$input;b.autofocus();a=b.getSelection();if(!a||1>=a.end)return!1;b=b.val().substring(0,a.end)}var d=b.lastIndexOf(this.options.at);if(-1===d)return null;if(0===d||b.substr(d-1,1).match(/(\s|[\](,]|--)/)){var e=b.substr(d+1);if(!e.match(/\s/)||15>=e.length)return{text:b,textNode:c,start:d,query:e.replace(new RegExp(String.fromCharCode(160),"g")," "),range:a}}return null},foundMatch:function(a){this.pendingQuery!==a&&(this.pendingQuery=a,a.length>=this.options.minLength&&"["!==a.substr(0,1)&&this.getPendingQueryOptions())},
getPendingQueryOptions:function(){XF.ajax(this.options.method,this.options.url,{q:this.pendingQuery},XF.proxy(this,"handlePendingQueryOptions"),{global:!1,error:!1})},handlePendingQueryOptions:function(a){var b=this.getCurrentMatchInfo();a.q&&b&&a.q===b.query&&(a.results&&a.results.length?this.show(a.q,a.results):this.hide())},insertResult:function(a){this.hide();var b=this.getCurrentMatchInfo();if(b){var c=b.start+1,f=b.range;if(this.ed){this.ed.selection.save();XF.EditorHelpers.focus(this.ed);f=
b.textNode;var e=f.nodeValue,g=f.splitText(this.options.keepAt?c:c-1);g.textContent=e.substr(c+b.query.length);a="html"===this.options.insertMode?d.parseHTML(a+"\u00a0"):k.createTextNode(a+"\u00a0");d(g).before(a);f.parentNode.normalize();this.ed.selection.restore()}else g=this.$input,g.autofocus(),-1!==c&&(g.setSelection(b.start,f.end),g.replaceSelectedText((this.options.keepAt?this.options.at:"")+a+" ","collapseToEnd"))}},show:function(a,b){var c=this.getCurrentMatchInfo(),f=this.$input,e=f.dimensions(),
g=this;if(c)if(this.visible=!0,this.ed){var l=c.range;this.results.showResults(a,b,f,function(a){if(!l||!l.getBoundingClientRect)return a=l.startContainer,{top:(3===a.nodeType?d(a.parentNode):d(a)).dimensions().bottom+3,left:e.left+5};var b=l.cloneRange();b.setStart(c.textNode,c.start);b.setEnd(c.textNode,c.start+1);b=b.getBoundingClientRect();return g.getResultPositionForSelection(b.left,b.bottom,l.getBoundingClientRect().left,a,e)})}else this.results.showResults(a,b,f,function(a){for(var b=d("<div />"),
l=h.getComputedStyle(f[0]),m,p="",v=0;v<l.length;v++)m=l[v],p+=m+": "+l.getPropertyValue(m)+"; ";b[0].style.cssText=p;b.css({position:"absolute",height:"",width:f.outerWidth(),opacity:0,top:0,left:"-9999px"});b[0].textContent=f.val();b.appendTo(k.body);p=k.createRange();p.setStart(b[0].firstChild,c.start);p.setEnd(b[0].firstChild,c.start+1);v=p.getBoundingClientRect();var t=b.dimensions();l=e.left+(v.left-t.left);m=e.top+(v.bottom-t.top);p.setStart(b[0].firstChild,c.start+1+c.query.length);p.setEnd(b[0].firstChild,
c.start+1+c.query.length);v=p.getBoundingClientRect();p=e.left+(v.left-t.left);b.remove();return g.getResultPositionForSelection(l,m,p,a,e)})},getResultPositionForSelection:function(a,b,c,f,e){f=f.width();b=b+d(h).scrollTop()+3;a+f>e.right&&(a=c-f);a<e.left&&(a=e.left);return{top:b,left:a}},hide:function(){this.visible&&(this.visible=!1,this.results.hideResults())}}),XF.pageDisplayTime=Date.now(),d(XF.onPageLoad),d(h).on("pageshow",function(){if(!XF.pageDisplayTime||Date.now()>XF.pageDisplayTime)XF.pageDisplayTime=
Date.now()}))}(window.jQuery,window,document);
